%code to check QMC with U' term vs calculated ground state for L=3=N,
%julia Uppigsfli.jl -D 1 -L 3 -N 3 --max 2 -l 1 -U 1  --Up 10 --mu .0001 --sweeps 100000 --seed 1 --measurement-frequency 25 --bin-size 10000 --bins-wanted 100 --num-replicas 1 --beta 5.0 --canonical true
%% Theoretical calculated for U' = 10
clc; clear all; close all

% Define the values of U
U_values = linspace(1, 10, 5);
J = 1; W = 10;
% Initialize an array to store the theoretical values
Theoretical_values = zeros(1, length(U_values));

% Calculate the theoretical values for each U
for i = 1:length(U_values)
    U = U_values(i);
    Theoretical_values(i) = real((4*U)/3 - J + W/3 - (3^(1/2)*((J*W - (U*W)/3 + (4*U - 3*J + W)^2/9 + 6*J^2 - U^2 + 3*J*U)/(((18*J^2*U + 6*J^2*W - (4*U - 3*J + W)^3/27 - ((4*U - 3*J + W)*(18*J^2 + 9*J*U + 3*W*J - 3*U^2 - W*U))/6)^2 - (J*W - (U*W)/3 + (4*U - 3*J + W)^2/9 + 6*J^2 - U^2 + 3*J*U)^3)^(1/2) - 18*J^2*U - 6*J^2*W + (4*U - 3*J + W)^3/27 + ((4*U - 3*J + W)*(18*J^2 + 9*J*U + 3*W*J - 3*U^2 - W*U))/6)^(1/3) - (((18*J^2*U + 6*J^2*W - (4*U - 3*J + W)^3/27 - ((4*U - 3*J + W)*(18*J^2 + 9*J*U + 3*W*J - 3*U^2 - W*U))/6)^2 - (J*W - (U*W)/3 + (4*U - 3*J + W)^2/9 + 6*J^2 - U^2 + 3*J*U)^3)^(1/2) - 18*J^2*U - 6*J^2*W + (4*U - 3*J + W)^3/27 + ((4*U - 3*J + W)*(18*J^2 + 9*J*U + 3*W*J - 3*U^2 - W*U))/6)^(1/3))*1i)/2 - (J*W - (U*W)/3 + (4*U - 3*J + W)^2/9 + 6*J^2 - U^2 + 3*J*U)/(2*(((18*J^2*U + 6*J^2*W - (4*U - 3*J + W)^3/27 - ((4*U - 3*J + W)*(18*J^2 + 9*J*U + 3*W*J - 3*U^2 - W*U))/6)^2 - (J*W - (U*W)/3 + (4*U - 3*J + W)^2/9 + 6*J^2 - U^2 + 3*J*U)^3)^(1/2) - 18*J^2*U - 6*J^2*W + (4*U - 3*J + W)^3/27 + ((4*U - 3*J + W)*(18*J^2 + 9*J*U + 3*W*J - 3*U^2 - W*U))/6)^(1/3)) - (((18*J^2*U + 6*J^2*W - (4*U - 3*J + W)^3/27 - ((4*U - 3*J + W)*(18*J^2 + 9*J*U + 3*W*J - 3*U^2 - W*U))/6)^2 - (J*W - (U*W)/3 + (4*U - 3*J + W)^2/9 + 6*J^2 - U^2 + 3*J*U)^3)^(1/2) - 18*J^2*U - 6*J^2*W + (4*U - 3*J + W)^3/27 + ((4*U - 3*J + W)*(18*J^2 + 9*J*U + 3*W*J - 3*U^2 - W*U))/6)^(1/3)/2);
end

% Display the results
disp('U values:');
disp(U_values);
disp('Theoretical values:');
disp(Theoretical_values);

%% Experimental (code) values where U' = 10

%For U = 1
KE1  = [-5.49030000000000040217
-5.71150000000000002132
-5.49580000000000001847
-5.69230000000000035953
-5.60540000000000038227
-5.66690000000000004832
-5.63790000000000013358
-5.56130000000000013216
-5.79079999999999994742
-5.83420000000000005258
-5.54610000000000002984
-5.54250000000000042633
-5.20370000000000043627
-5.82350000000000012079
-5.63889999999999957936
-5.50490000000000012648
-5.72930000000000028137
-5.64149999999999973710
-5.70380000000000020322
-5.51579999999999959215
-5.66450000000000031264
-5.81859999999999999432
-5.71370000000000022311
-5.54150000000000009237
-5.63250000000000028422
-5.52299999999999968736
-5.47280000000000033111
-5.69040000000000034674
-5.68780000000000018900
-5.47189999999999976410
-5.71900000000000030553
-5.58980000000000032401
-5.66929999999999978400
-5.70589999999999974989
-5.68269999999999964047
-5.77379999999999959925
-5.69160000000000021458
-5.65829999999999966320
-5.95629999999999970584
-5.86979999999999968452
-5.44390000000000018332
-5.89710000000000000853
-5.64210000000000011511
-5.39090000000000024727
-5.54959999999999986642
-5.38910000000000000142
-5.27139999999999986358
-5.54300000000000014921
-5.54549999999999965183
-5.64320000000000021600
-5.60780000000000011795
-5.93850000000000033396
-5.54589999999999960778
-5.65120000000000022311
-5.60690000000000043912
-5.73470000000000013074
-5.79300000000000014921
-5.64329999999999998295
-5.96070000000000010942
-5.71520000000000027995
-5.56240000000000023306
-5.69479999999999986215
-5.64879999999999959925
-5.57960000000000011511
-5.67729999999999979110
-5.71780000000000043769
-5.67309999999999980957
-5.64170000000000015916
-5.58980000000000032401
-5.47860000000000013642
-5.49030000000000040217
-5.69380000000000041638
-5.67600000000000015632
-5.43569999999999975415
-5.35550000000000014921
-5.86249999999999982236
-5.37150000000000016342
-5.70169999999999976836
-5.72250000000000014211
-5.44840000000000035385
-5.67389999999999972147
-5.89079999999999959215
-5.49420000000000019469
-5.32469999999999998863
-5.44120000000000025864
-5.69299999999999961631
-5.85810000000000030695
-5.37690000000000001279
-5.56020000000000003126
-5.68649999999999966604
-5.82519999999999971152
-5.82650000000000023448
-5.48460000000000036380
-5.94010000000000015774
-5.62089999999999978542
-5.70589999999999974989
-5.57249999999999978684
-5.68639999999999989910
-5.55499999999999971578
-5.65320000000000000284
];
PE1 = [0.69350000000000000533
0.68549999999999999822
0.70350000000000001421
0.68230000000000001759
0.68400000000000005240
0.69379999999999997229
0.70740000000000002878
0.68179999999999996163
0.67830000000000001403
0.69530000000000002913
0.70299999999999995826
0.67869999999999996998
0.68820000000000003393
0.66010000000000002007
0.67479999999999995541
0.68589999999999995417
0.68969999999999997975
0.67569999999999996732
0.69040000000000001368
0.70040000000000002256
0.66939999999999999503
0.69799999999999995381
0.70079999999999997851
0.66879999999999995008
0.68440000000000000835
0.66369999999999995666
0.64180000000000003713
0.70899999999999996358
0.69159999999999999254
0.66449999999999997957
0.67530000000000001137
0.68569999999999997620
0.69140000000000001457
0.66510000000000002451
0.68179999999999996163
0.68750000000000000000
0.68659999999999998810
0.66910000000000002807
0.69259999999999999343
0.70750000000000001776
0.69879999999999997673
0.68559999999999998721
0.69150000000000000355
0.69930000000000003268
0.68720000000000003304
0.69050000000000000266
0.66730000000000000426
0.68259999999999998455
0.68140000000000000568
0.66479999999999994653
0.65929999999999999716
0.67579999999999995630
0.68600000000000005418
0.69420000000000003926
0.67310000000000003162
0.67559999999999997833
0.69659999999999999698
0.65849999999999997424
0.69299999999999994937
0.67989999999999994884
0.71189999999999997726
0.68030000000000001581
0.66229999999999999982
0.70840000000000002967
0.71799999999999997158
0.70169999999999999041
0.71440000000000003499
0.69550000000000000711
0.67439999999999999947
0.69940000000000002167
0.65029999999999998916
0.67920000000000002593
0.70720000000000005080
0.66910000000000002807
0.69769999999999998685
0.69369999999999998330
0.67369999999999996554
0.67169999999999996376
0.70769999999999999574
0.70320000000000004725
0.66749999999999998224
0.69179999999999997051
0.66139999999999998792
0.66449999999999997957
0.71209999999999995524
0.69559999999999999609
0.71230000000000004423
0.68769999999999997797
0.66890000000000005009
0.69310000000000004938
0.71399999999999996803
0.69710000000000005294
0.67520000000000002238
0.71709999999999995968
0.67479999999999995541
0.68100000000000004974
0.70840000000000002967
0.67030000000000000693
0.65159999999999995701
0.68979999999999996874
];
KE1avg = mean(KE1); 
PE1avg = mean(PE1);
sum1 = KE1avg + PE1avg

%U = 3.25
KE2  = [-5.05330000000000012506
-5.04670000000000040785
-4.97029999999999994031
-5.30520000000000013785
-5.31799999999999961631
-5.31839999999999957225
-5.38060000000000027143
-5.20990000000000019753
-5.22689999999999965752
-5.37349999999999994316
-5.46239999999999970015
-5.31160000000000032117
-5.15810000000000012932
-5.28899999999999970157
-5.05520000000000013785
-5.05520000000000013785
-4.90730000000000021743
-5.05389999999999961489
-5.08549999999999968736
-5.29839999999999999858
-5.08760000000000012221
-5.44749999999999978684
-5.18559999999999998721
-5.22590000000000021174
-4.95749999999999957367
-5.41159999999999996589
-5.39400000000000012790
-5.38949999999999995737
-5.08439999999999958646
-5.16349999999999997868
-5.32249999999999978684
-5.14670000000000005258
-5.04199999999999981526
-5.39280000000000026006
-5.14309999999999956088
-5.38210000000000032827
-5.12129999999999974136
-5.01850000000000040501
-4.94130000000000002558
-5.14109999999999978115
-5.27320000000000010942
-5.40430000000000010374
-5.39759999999999973141
-5.50300000000000011369
-5.18529999999999979821
-5.06920000000000037232
-5.21039999999999992042
-5.16619999999999990337
-5.26229999999999975557
-5.17279999999999962057
-5.28120000000000011653
-5.05560000000000009379
-5.17940000000000022595
-4.92799999999999993605
-5.17780000000000040217
-5.15280000000000004690
-5.24690000000000011937
-5.54199999999999981526
-5.37739999999999973568
-5.43160000000000042775
-5.10419999999999962625
-5.35120000000000040075
-5.22370000000000000995
-5.22959999999999958220
-5.06149999999999966604
-5.36699999999999999289
-5.13680000000000003268
-5.27479999999999993321
-5.11179999999999967741
-5.49669999999999969731
-5.00919999999999987494
-5.11749999999999971578
-5.27479999999999993321
-5.42039999999999988489
-5.02130000000000009663
-5.08710000000000039933
-5.38109999999999999432
-5.02320000000000010942
-5.40409999999999968168
-5.28120000000000011653
-5.00079999999999991189
-4.94160000000000021458
-5.00980000000000025295
-5.13600000000000012079
-5.19629999999999991900
-5.35069999999999978968
-5.13940000000000019043
-5.23939999999999983515
-5.17539999999999977831
-5.28219999999999956231
-5.18489999999999984226
-5.26330000000000008953
-5.35160000000000035669
-5.04159999999999985931
-5.03629999999999977689
-5.04420000000000001705
-5.15969999999999995310
-5.33450000000000024158
-5.33009999999999983800
-5.27029999999999976268
];
PE2 = [1.66789999999999993818
1.59932500000000010765
1.56747499999999995168
1.77580000000000004512
1.68057499999999993001
1.71827499999999999680
1.69877499999999992397
1.64742499999999991722
1.62792500000000006644
1.71697499999999991793
1.72314999999999995950
1.67635000000000000675
1.64775000000000004796
1.58404999999999995808
1.60420000000000007034
1.69682500000000002771
1.57040000000000001812
1.69714999999999993641
1.63539999999999996483
1.67732499999999995488
1.65067499999999989235
1.72379999999999999893
1.69097499999999989484
1.61232500000000000817
1.58762500000000006395
1.74720000000000008633
1.74362499999999998046
1.71047499999999996767
1.67862500000000003375
1.73582499999999995133
1.72055000000000002380
1.65847499999999992149
1.68155000000000010019
1.79465000000000007851
1.66985000000000005649
1.66399999999999992362
1.58762500000000006395
1.62077500000000007674
1.64417499999999994209
1.64644999999999996909
1.73485000000000000320
1.69032500000000007745
1.68544999999999989271
1.66107500000000007923
1.78977499999999989377
1.67244999999999999218
1.70754999999999990123
1.61037499999999988987
1.64677500000000009983
1.66042500000000003979
1.61200000000000009948
1.65424999999999999822
1.64385000000000003340
1.54472499999999990372
1.70137500000000008171
1.66822500000000006892
1.67147500000000004405
1.79042499999999993321
1.61557499999999998330
1.75662500000000010303
1.65392500000000008953
1.77255000000000006999
1.65652500000000002522
1.61427499999999990443
1.67667499999999991545
1.66660000000000008136
1.62467500000000009130
1.75954999999999994742
1.55804999999999993499
1.71567500000000006111
1.56065000000000009273
1.77320000000000010942
1.67472500000000001918
1.73679999999999989946
1.61460000000000003517
1.71177500000000004654
1.69942499999999996341
1.67212500000000008349
1.75597500000000006359
1.62369999999999992113
1.69130000000000002558
1.61785000000000001030
1.66367500000000001492
1.63929999999999997939
1.66367500000000001492
1.79269999999999996021
1.65847499999999992149
1.70104999999999995097
1.64254999999999995453
1.62305000000000010374
1.75272500000000008846
1.70104999999999995097
1.69227499999999997371
1.59282499999999993534
1.62207499999999993356
1.60549999999999992717
1.71340000000000003411
1.78392499999999998295
1.74492500000000005933
1.72347500000000009024
];
KE2avg = mean(KE2);
PE2avg = mean(PE2);
sum2 = KE2avg + PE2avg

%U = 5.5
KE3  = [-4.57029999999999958504
-4.41910000000000025011
-4.29710000000000036380
-4.41730000000000000426
-4.46570000000000000284
-4.55930000000000035243
-4.54629999999999956373
-4.43320000000000025153
-4.45479999999999964899
-4.34839999999999982094
-4.48899999999999987921
-4.33190000000000008384
-4.49990000000000023306
-4.35179999999999989058
-4.64989999999999970015
-4.45300000000000029132
-4.55459999999999975984
-4.45760000000000022879
-4.54570000000000007390
-4.46600000000000019185
-4.55030000000000001137
-4.47320000000000028706
-4.32620000000000004547
-4.54520000000000035101
-4.45549999999999979394
-4.32260000000000044196
-4.45460000000000011511
-4.54370000000000029416
-4.45389999999999997016
-4.34049999999999958078
-4.41830000000000033822
-4.39730000000000043059
-4.39390000000000036096
-4.51199999999999956657
-4.71370000000000022311
-4.28540000000000009805
-4.41410000000000035669
-4.36720000000000041496
-4.46530000000000004690
-4.45920000000000005258
-4.37610000000000010090
-4.45800000000000018474
-4.38849999999999962341
-4.29750000000000031974
-4.40479999999999982663
-4.54429999999999978400
-4.59919999999999973284
-4.33460000000000000853
-4.31709999999999993747
-4.43140000000000000568
-4.46830000000000016058
-4.49849999999999994316
-4.42459999999999986642
-4.33300000000000018474
-4.41140000000000043201
-4.63640000000000007674
-4.26980000000000003979
-4.29000000000000003553
-4.47309999999999963194
-4.52709999999999990195
-4.65730000000000021743
-4.37910000000000021458
-4.46929999999999960636
-4.56820000000000003837
-4.39269999999999960494
-4.66680000000000028137
-4.76320000000000032259
-4.51649999999999973710
-4.40580000000000016058
-4.33450000000000024158
-4.34560000000000012932
-4.54689999999999994174
-4.30999999999999960920
-4.61390000000000011227
-4.32399999999999984368
-4.44050000000000011369
-4.48350000000000026290
-4.27970000000000005969
-4.55869999999999997442
-4.32120000000000015206
-4.49830000000000040927
-4.36589999999999989200
-4.58610000000000006537
-4.59579999999999966320
-4.55879999999999974136
-4.35079999999999955662
-4.54839999999999999858
-4.42079999999999984084
-4.41709999999999958220
-4.30199999999999960210
-4.41990000000000016200
-4.53209999999999979536
-4.44249999999999989342
-4.31630000000000002558
-4.34550000000000036238
-4.51860000000000017195
-4.30320000000000035811
-4.38400000000000034106
-4.24030000000000040217
-4.55989999999999984226
];
PE3 = [1.99924999999999997158
1.84745000000000003659
1.73799999999999998934
1.86284999999999989484
1.93930000000000002380
1.99265000000000003233
1.92169999999999996376
1.98330000000000006288
1.91454999999999997407
1.87494999999999989448
1.94150000000000000355
1.83315000000000005720
1.89585000000000003517
1.87109999999999998543
1.98275000000000001243
1.92005000000000003446
1.98055000000000003268
1.95744999999999991225
1.92995000000000005436
2.03774999999999995026
1.85899999999999998579
1.93490000000000006430
1.86119999999999996554
1.93104999999999993321
1.93379999999999996341
1.86284999999999989484
1.90135000000000009557
1.91179999999999994387
1.91510000000000002451
1.79960000000000008846
1.93874999999999997335
1.94864999999999999325
1.90739999999999998437
1.94480000000000008420
1.99374999999999991118
1.85569999999999990514
1.99265000000000003233
1.97229999999999994209
1.95910000000000006359
1.88319999999999998508
1.91124999999999989342
1.91785000000000005471
1.98439999999999994174
1.98770000000000002238
1.96459999999999990195
2.00804999999999989058
2.03885000000000005116
1.86339999999999994529
1.89585000000000003517
1.98714999999999997193
1.93215000000000003411
1.98110000000000008313
1.90024999999999999467
1.84965000000000001634
1.92225000000000001421
2.16040000000000009805
1.87494999999999989448
1.81554999999999999716
1.97174999999999989164
1.93930000000000002380
1.96019999999999994245
1.82984999999999997655
2.01299999999999990052
1.95415000000000005365
1.88650000000000006573
2.09604999999999996874
2.02125000000000021316
1.89914999999999989377
1.93379999999999996341
1.85349999999999992539
1.90189999999999992397
1.94589999999999996305
1.84194999999999997620
1.99485000000000001208
1.91949999999999998401
1.86614999999999997549
2.07240000000000001990
1.90959999999999996412
1.92280000000000006466
1.91785000000000005471
2.10044999999999992824
1.93985000000000007425
2.11529999999999995808
2.02565000000000017266
1.87549999999999994493
2.01849999999999996092
1.87715000000000009628
2.06305000000000005045
1.91949999999999998401
1.87000000000000010658
1.95029999999999992255
2.01960000000000006182
1.93985000000000007425
1.83590000000000008740
1.89254999999999995453
1.96900000000000008349
1.81390000000000006786
1.78970000000000006857
1.87935000000000007603
1.87989999999999990443
];
KE3avg = mean(KE3);
PE3avg = mean(PE3);
sum3 = KE3avg + PE3avg

%U = 7.75
KE4  = [-3.64060000000000005826
-3.77280000000000015348
-3.50289999999999990266
-3.64789999999999992042
-3.65240000000000009095
-3.65519999999999978257
-3.58009999999999983800
-3.62409999999999987708
-3.90609999999999990550
-3.40720000000000000639
-3.58130000000000014992
-3.67490000000000005542
-3.59960000000000013287
-3.78569999999999984297
-3.64639999999999986358
-3.85559999999999991616
-3.62900000000000000355
-3.72449999999999992184
-3.52999999999999980460
-3.55920000000000014140
-3.84350000000000013856
-3.58400000000000007461
-3.77970000000000005969
-3.68529999999999979821
-3.38669999999999982165
-3.70380000000000020322
-3.71119999999999983231
-3.52070000000000016271
-3.61180000000000012150
-3.60259999999999980247
-3.73579999999999978755
-3.46309999999999984510
-3.71709999999999984865
-3.68389999999999995239
-3.77369999999999983231
-3.67620000000000013429
-3.47460000000000013287
-3.73769999999999980034
-3.68909999999999982379
-4.03409999999999957510
-3.51189999999999979963
-3.74350000000000004974
-3.56269999999999997797
-3.53359999999999985221
-3.64429999999999987281
-3.70840000000000014069
-3.44680000000000008598
-3.62250000000000005329
-3.48609999999999997655
-3.69890000000000007674
-3.73159999999999980602
-3.56280000000000018900
-3.69930000000000003268
-3.40160000000000017906
-3.66460000000000007958
-3.76140000000000007674
-3.46340000000000003411
-3.54919999999999991047
-3.69910000000000005471
-3.89570000000000016271
-3.33530000000000015348
-3.51299999999999990052
-3.61710000000000020393
-3.53129999999999988347
-3.59509999999999996234
-3.59390000000000009450
-3.75519999999999987139
-3.65289999999999981384
-3.71910000000000007248
-3.56020000000000003126
-3.60029999999999983373
-3.84500000000000019540
-3.50170000000000003482
-3.37559999999999993392
-3.55339999999999989200
-3.61810000000000009379
-3.55569999999999986073
-3.82180000000000008598
-3.70259999999999989129
-3.49080000000000012506
-3.62559999999999993392
-3.50450000000000017053
-3.67419999999999991047
-3.67320000000000002061
-3.62550000000000016698
-3.43780000000000018900
-3.63969999999999993534
-3.52199999999999979750
-3.70679999999999987281
-3.65580000000000016058
-3.39420000000000010587
-3.55670000000000019469
-3.49889999999999989910
-3.49129999999999984794
-3.46830000000000016058
-3.64349999999999996092
-3.76569999999999982521
-3.52760000000000006892
-3.54249999999999998224
-3.51290000000000013358
];
PE4 = [1.66005000000000002558
2.03204999999999991189
1.61975000000000002309
1.85767499999999996518
1.85224999999999995204
1.80962500000000003908
1.74917499999999992433
1.73910000000000009024
1.93362499999999992717
1.59959999999999991083
1.80729999999999990656
1.76622499999999993392
1.86077500000000006786
1.84837500000000010125
1.71740000000000003766
1.81659999999999999254
1.80109999999999992326
1.75227500000000002700
1.68330000000000001847
1.66159999999999996589
1.88247499999999989839
1.84837500000000010125
1.92122499999999996056
1.81582500000000002238
1.65074999999999993960
1.71197500000000002451
1.83597499999999991260
1.77397500000000007958
1.70887499999999992184
1.77164999999999994706
1.80187499999999989342
1.67322499999999996234
1.81427500000000008207
1.81117499999999997939
1.85922499999999990550
1.90107500000000007034
1.69880000000000008775
1.88945000000000007390
1.72127500000000011049
1.93595000000000005969
1.61355000000000003979
1.76079999999999992077
1.83132500000000009166
1.66779999999999994920
1.74219999999999997087
1.78869999999999995666
1.55852499999999993818
1.70500000000000007105
1.72592499999999993143
1.81194999999999994955
1.72592499999999993143
1.83210000000000006182
1.85147499999999998188
1.56162500000000004086
1.69337500000000007461
1.83830000000000004512
1.65694999999999992291
1.74219999999999997087
1.69027499999999997193
1.82745000000000001883
1.68097500000000010800
1.72437499999999999112
1.72669999999999990159
1.59184999999999998721
1.74219999999999997087
1.67710000000000003517
1.89409999999999989484
1.74994999999999989448
1.73367500000000007709
1.75072500000000008669
1.71197500000000002451
1.86155000000000003801
1.69337500000000007461
1.72282500000000005080
1.75770000000000004015
1.79954999999999998295
1.77629999999999999005
1.85070000000000001172
1.66159999999999996589
1.64919999999999999929
1.82977499999999992930
1.74530000000000007354
1.74839999999999995417
1.77862499999999990052
1.64145000000000007567
1.73677499999999995772
1.79102500000000008917
1.72980000000000000426
1.78637500000000004619
1.79877500000000001279
1.55154999999999998472
1.62749999999999994671
1.62207499999999993356
1.70189999999999996838
1.85070000000000001172
1.84062499999999995559
1.80497499999999999609
1.67864999999999997549
1.82745000000000001883
1.58099999999999996092
];
KE4avg = mean(KE4);
PE4avg = mean(PE4);
sum4 = KE4avg + PE4avg

%U = 10
KE5  = [-2.79050000000000020250
-2.85499999999999998224
-2.83429999999999981952
-2.87080000000000001847
-2.86030000000000006466
-3.10389999999999988134
-2.96580000000000021387
-2.90859999999999985221
-3.09100000000000019185
-2.92090000000000005187
-2.99089999999999989200
-2.95100000000000006750
-3.04389999999999982805
-2.91380000000000016769
-2.78250000000000019540
-3.19229999999999991545
-2.86529999999999995808
-3.04870000000000018758
-2.94300000000000006040
-2.90399999999999991473
-2.81490000000000017977
-2.86859999999999981668
-2.93210000000000015064
-2.96879999999999988347
-2.86799999999999988276
-2.88540000000000018687
-2.97659999999999991260
-2.86580000000000012506
-2.86249999999999982236
-2.77610000000000001208
-2.95460000000000011511
-2.98839999999999994529
-2.91559999999999996945
-3.00729999999999986215
-2.85190000000000010161
-2.76520000000000010232
-2.99000000000000021316
-2.70869999999999988560
-3.13710000000000022169
-3.07370000000000009877
-3.03040000000000020464
-2.85389999999999988134
-2.96899999999999986144
-2.84419999999999983942
-2.84039999999999981384
-3.11459999999999981313
-2.83510000000000017550
-2.95529999999999981597
-3.06510000000000015774
-2.93809999999999993392
-3.17779999999999995808
-2.98839999999999994529
-3.02130000000000009663
-3.04829999999999978755
-3.10559999999999991616
-2.93420000000000014140
-2.78310000000000012932
-3.07739999999999991331
-2.81639999999999979252
-2.91599999999999992539
-2.89020000000000010232
-3.23780000000000001137
-2.95949999999999979750
-3.09089999999999998082
-3.07419999999999982165
-2.94790000000000018687
-2.69079999999999985860
-2.85979999999999989768
-2.96839999999999992752
-2.79240000000000021529
-3.01330000000000008953
-3.06130000000000013216
-3.07089999999999996305
-2.85369999999999990337
-2.94439999999999990621
-2.87659999999999982379
-2.90640000000000009450
-3.23729999999999984439
-2.78679999999999994387
-2.89599999999999990763
-2.73189999999999999503
-3.01630000000000020322
-2.74259999999999992681
-3.06990000000000007319
-2.85720000000000018403
-2.96090000000000008740
-2.95820000000000016271
-3.14340000000000019398
-2.91679999999999983729
-2.94530000000000002913
-3.01869999999999993889
-3.00570000000000003837
-2.92569999999999996732
-2.88050000000000006040
-3.05279999999999995808
-3.16290000000000004476
-2.99580000000000001847
-2.93650000000000011013
-2.75340000000000006963
-3.05909999999999993037
];
PE5 = [1.36299999999999998934
1.48500000000000009770
1.53699999999999992184
1.35099999999999997868
1.41100000000000003197
1.53000000000000002665
1.57899999999999995914
1.53899999999999992362
1.45900000000000007461
1.34899999999999997691
1.52000000000000001776
1.48700000000000009948
1.66500000000000003553
1.42599999999999993427
1.47500000000000008882
1.76000000000000000888
1.56699999999999994849
1.41700000000000003730
1.40700000000000002842
1.51600000000000001421
1.32200000000000006395
1.39399999999999990585
1.33800000000000007816
1.47199999999999997513
1.40100000000000002309
1.48199999999999998401
1.55600000000000004974
1.52499999999999991118
1.42300000000000004263
1.35800000000000009592
1.55000000000000004441
1.52000000000000001776
1.54000000000000003553
1.71199999999999996625
1.37599999999999988987
1.42100000000000004086
1.56000000000000005329
1.33899999999999996803
1.66700000000000003730
1.44799999999999995381
1.51200000000000001066
1.39799999999999990941
1.57600000000000006750
1.35800000000000009592
1.40300000000000002487
1.53099999999999991651
1.47199999999999997513
1.42999999999999993783
1.53499999999999992006
1.49100000000000010303
1.66199999999999992184
1.48599999999999998757
1.48199999999999998401
1.47599999999999997868
1.62099999999999999645
1.54000000000000003553
1.44999999999999995559
1.60800000000000009592
1.36499999999999999112
1.49199999999999999289
1.45799999999999996270
1.59000000000000007994
1.59400000000000008349
1.54299999999999992717
1.46700000000000008171
1.44100000000000005862
1.39500000000000001776
1.39999999999999991118
1.48700000000000009948
1.30099999999999993427
1.51499999999999990230
1.55800000000000005151
1.57000000000000006217
1.49900000000000011013
1.65700000000000002842
1.34899999999999997691
1.42700000000000004619
1.77200000000000001954
1.43300000000000005151
1.49900000000000011013
1.38999999999999990230
1.60299999999999998046
1.39900000000000002132
1.57800000000000006928
1.46300000000000007816
1.47500000000000008882
1.59400000000000008349
1.71700000000000008171
1.49399999999999999467
1.49799999999999999822
1.61699999999999999289
1.52499999999999991118
1.39500000000000001776
1.45399999999999995914
1.57699999999999995737
1.62799999999999989164
1.49300000000000010481
1.59499999999999997335
1.43300000000000005151
1.46300000000000007816
];
KE5avg = mean(KE5);
PE5avg = mean(PE5);
sum5 = KE5avg + PE5avg

sum_values = [sum1, sum2, sum3, sum4, sum5]; % replace with actual sum values

%Find standard deiation which will be used as error bars
KE1std = std(KE1);
KE2std = std(KE2);
KE3std = std(KE3);
KE4std = std(KE4);
KE5std = std(KE5);

PE1std = std(PE1);
PE2std = std(PE2);
PE3std = std(PE3);
PE4std = std(PE4);
PE5std = std(PE5);

totalstd1 = sqrt(KE1std^2 + PE1std^2);
totalstd2 = sqrt(KE2std^2 + PE2std^2);
totalstd3 = sqrt(KE3std^2 + PE3std^2);
totalstd4 = sqrt(KE4std^2 + PE4std^2);
totalstd5 = sqrt(KE5std^2 + PE5std^2);
totalstd = [totalstd1, totalstd2, totalstd3, totalstd4, totalstd5];

%% Plotting the results
figure;
errorbar(U_values, sum_values, totalstd, 'x-', 'DisplayName', 'QMC Values','LineWidth', 1);
hold on;
plot(U_values, Theoretical_values, 'o', 'DisplayName', 'Theoretical Values','LineWidth', 2);
hold on;
xlabel('U/J');
ylabel('Energy');
title('Comparison of Theoretical and QMC Values for L=N=3,U'' = 10, beta = 5');
legend('Location', 'southeast'); % Set the legend location to bottom right


%% Test U' = 1000 QMC  vs the 2x2 nmax = 2 theoretical case

% Theoretical calculated for nmax = 2
clc; clear all; close all
% Define the values of U
U_values = [0,linspace(1, 10, 5)];
J = 1;
% Initialize an array to store the theoretical values
Theoretical_values = zeros(1, length(U_values));

% Calculate the theoretical values for each U
for i = 1:length(U_values)
    U = U_values(i);
    Theoretical_values(i) = real( U/2 - (3*J)/2 - (57*J^2 - 6*J*U + U^2)^(1/2)/2);
end

% Display the results
disp('U values:');
disp(U_values);
disp('Theoretical values:');
disp(Theoretical_values);

%Experimental (code) values where U' = 1000
%For U = 0
KE0  = [-5.30170000000000030127
-5.15909999999999957510
-5.29380000000000006111
-5.33499999999999996447
-5.14789999999999992042
-5.22689999999999965752
-5.24549999999999982947
-5.26579999999999959215
-5.33769999999999988916
-5.32610000000000027853
-5.26250000000000017764
-5.22240000000000037517
-5.21309999999999984510
-5.38879999999999981242
-5.42020000000000035101
-5.25020000000000042206
-5.24629999999999974136
-5.37539999999999995595
-5.11580000000000012506
-5.32249999999999978684
-5.11129999999999995453
-5.47039999999999970726
-5.22100000000000008527
-5.12319999999999975415
-5.20180000000000042348
-5.36660000000000003695
-5.26069999999999993179
-5.24479999999999968452
-5.21499999999999985789
-5.14689999999999958646
-5.41779999999999972715
-5.18130000000000023874
-5.25250000000000039080
-5.32260000000000044196
-5.25000000000000000000
-5.23500000000000031974
-5.33889999999999975699
-5.12289999999999956515
-5.54849999999999976552
-5.22440000000000015490
-5.27550000000000007816
-5.03340000000000031832
-5.37260000000000026432
-5.35449999999999981526
-5.28659999999999996589
-5.14440000000000008384
-5.52259999999999973141
-5.28629999999999977689
-5.38759999999999994458
-5.23449999999999970868
-5.19869999999999965468
-5.08619999999999983231
-5.34909999999999996589
-5.23979999999999979110
-5.26149999999999984368
-5.12370000000000036522
-5.40749999999999975131
-5.24009999999999998010
-5.08629999999999959925
-5.14299999999999979394
-5.18440000000000011937
-5.09759999999999990905
-5.24739999999999984226
-5.38619999999999965468
-5.09790000000000009805
-5.40960000000000018616
-5.22159999999999957510
-5.35799999999999965183
-5.27259999999999973141
-5.40109999999999956799
-5.20279999999999986926
-5.40470000000000005969
-5.08199999999999985079
-5.38130000000000041638
-5.38100000000000022737
-5.25769999999999981810
-5.12509999999999976694
-5.26550000000000029132
-5.30090000000000038938
-5.23460000000000036380
-5.32490000000000041069
-5.20559999999999956088
-5.59090000000000042490
-5.67079999999999984084
-5.32570000000000032259
-5.15259999999999962483
-5.28929999999999989058
-5.26100000000000012079
-5.32359999999999988773
-5.39540000000000041780
-5.05860000000000020748
-5.40719999999999956231
-5.30109999999999992326
-5.39449999999999985079
-5.22550000000000025580
-5.29019999999999956941
-5.23730000000000028848
-5.28390000000000004121
-5.32430000000000003268
-5.35390000000000032543
];
PE0 = [0];
KE0avg = mean(KE0); 
PE0avg = mean(PE0);
sum0 = KE0avg + PE0avg

%For U = 1
KE1  = [-5.11669999999999980389
-5.01360000000000027853
-5.13089999999999957225
-5.20720000000000027285
-5.20779999999999976268
-5.38510000000000044196
-5.19029999999999969162
-5.22879999999999967031
-5.14339999999999974989
-5.29959999999999986642
-5.33859999999999956799
-5.09459999999999979536
-5.12260000000000026432
-5.36169999999999991047
-5.18379999999999974136
-5.31749999999999989342
-5.11530000000000040217
-5.19010000000000015774
-5.22090000000000031832
-5.16319999999999978968
-5.05489999999999994884
-5.41249999999999964473
-4.99420000000000019469
-5.22459999999999968878
-5.31690000000000040359
-5.28460000000000018616
-5.18630000000000013216
-5.18210000000000015064
-5.28139999999999965041
-5.08279999999999976268
-5.35860000000000002984
-5.12319999999999975415
-5.16760000000000019327
-5.22229999999999972005
-5.28239999999999998437
-5.23780000000000001137
-5.12589999999999967883
-5.39559999999999995168
-5.16319999999999978968
-5.08969999999999966889
-5.32160000000000010800
-5.22679999999999989058
-5.30470000000000041496
-5.14920000000000044338
-5.17799999999999993605
-5.20619999999999993889
-5.27899999999999991473
-5.28409999999999957510
-5.23529999999999962057
-5.28749999999999964473
-5.33279999999999976268
-5.33140000000000036096
-5.05560000000000009379
-5.12990000000000012648
-5.05370000000000008100
-5.18900000000000005684
-5.15650000000000030553
-5.18780000000000018900
-5.29860000000000042064
-5.30060000000000020037
-5.41420000000000012363
-5.26280000000000036664
-5.23690000000000033253
-5.29980000000000028848
-5.18250000000000010658
-5.25509999999999966036
-5.30379999999999984794
-5.39259999999999983800
-5.34539999999999970726
-5.27569999999999961204
-5.26499999999999968026
-5.09480000000000021743
-5.34280000000000043769
-5.21659999999999968168
-5.20220000000000037943
-5.16769999999999996021
-5.15629999999999988347
-5.29969999999999963336
-5.34079999999999976978
-5.19969999999999998863
-5.45260000000000033538
-5.11800000000000032685
-5.35219999999999984652
-5.32559999999999966747
-5.27620000000000022311
-5.23550000000000004263
-5.25220000000000020179
-5.30370000000000008100
-5.19430000000000013927
-5.22240000000000037517
-5.38879999999999981242
-5.25910000000000010800
-5.20790000000000041780
-5.27529999999999965610
-5.25370000000000025864
-5.29290000000000038227
-5.30339999999999989200
-5.33940000000000036806
-5.30590000000000028280
-5.30909999999999993037
];
PE1 = [0.63160000000000005027
0.64219999999999999307
0.65110000000000001208
0.63370000000000004103
0.62860000000000004761
0.63209999999999999520
0.63290000000000001812
0.64929999999999998828
0.63870000000000004547
0.64770000000000005347
0.62199999999999999734
0.65359999999999995879
0.62670000000000003482
0.64480000000000003979
0.63709999999999999964
0.61770000000000002682
0.63249999999999995115
0.63400000000000000799
0.63060000000000004938
0.64000000000000001332
0.64310000000000000497
0.62419999999999997708
0.62949999999999994849
0.64639999999999997460
0.64059999999999994724
0.64129999999999998117
0.64980000000000004423
0.62580000000000002292
0.64270000000000004903
0.63070000000000003837
0.64510000000000000675
0.63780000000000003357
0.63509999999999999787
0.65600000000000002753
0.63119999999999998330
0.63609999999999999876
0.65229999999999999094
0.64390000000000002789
0.63460000000000005294
0.60960000000000003073
0.64970000000000005524
0.63980000000000003535
0.62860000000000004761
0.65380000000000004778
0.64249999999999996003
0.63590000000000002078
0.63859999999999994547
0.63680000000000003268
0.64359999999999994991
0.66339999999999998970
0.61990000000000000657
0.63939999999999996838
0.63039999999999996039
0.64670000000000005258
0.61790000000000000480
0.63519999999999998685
0.65090000000000003411
0.63239999999999996216
0.63859999999999994547
0.63829999999999997851
0.63280000000000002913
0.64580000000000004068
0.64529999999999998472
0.65120000000000000107
0.64139999999999997016
0.64480000000000003979
0.62270000000000003126
0.64849999999999996536
0.64180000000000003713
0.64529999999999998472
0.64110000000000000320
0.63490000000000001990
0.63580000000000003180
0.64870000000000005436
0.63739999999999996660
0.63590000000000002078
0.65049999999999996714
0.64359999999999994991
0.64870000000000005436
0.64149999999999995914
0.63829999999999997851
0.62609999999999998987
0.63990000000000002434
0.62829999999999996962
0.64670000000000005258
0.63580000000000003180
0.64739999999999997549
0.64729999999999998650
0.63700000000000001066
0.64429999999999998384
0.65280000000000004690
0.64870000000000005436
0.63319999999999998508
0.65049999999999996714
0.63849999999999995648
0.64270000000000004903
0.63590000000000002078
0.63460000000000005294
0.64549999999999996270
0.62800000000000000266
];
KE1avg = mean(KE1); 
PE1avg = mean(PE1);
sum1 = KE1avg + PE1avg

%U = 3.25
KE2  = [-4.90259999999999962483
-4.85869999999999979678
-5.04380000000000006111
-4.94979999999999975557
-4.73759999999999958931
-5.07150000000000034106
-4.86050000000000004263
-4.95049999999999990052
-4.87380000000000013216
-5.01850000000000040501
-4.89160000000000039222
-5.00619999999999976126
-5.04330000000000033822
-4.98099999999999987210
-4.92149999999999998579
-4.93599999999999994316
-4.85890000000000021885
-4.87289999999999956515
-4.84419999999999983942
-4.89789999999999992042
-4.95120000000000004547
-4.80400000000000027001
-4.95669999999999966178
-4.76930000000000031690
-4.83980000000000032401
-5.10879999999999956373
-4.93890000000000028990
-4.83319999999999971863
-4.89369999999999993889
-4.97470000000000034390
-5.08560000000000034248
-4.78139999999999965041
-5.03300000000000036238
-5.08410000000000028564
-4.89409999999999989484
-4.96250000000000035527
-4.84379999999999988347
-4.77010000000000022879
-4.95999999999999996447
-4.84360000000000034959
-4.90470000000000005969
-4.80689999999999972857
-4.96340000000000003411
-4.90409999999999968168
-4.92539999999999977831
-5.00330000000000030269
-4.82490000000000041069
-4.78450000000000041922
-4.94460000000000032827
-5.00440000000000040359
-4.92199999999999970868
-4.89130000000000020322
-4.85050000000000025580
-4.90719999999999956231
-4.73329999999999984084
-5.00549999999999961631
-4.94280000000000008242
-4.84440000000000026148
-4.82540000000000013358
-5.01890000000000036096
-4.76590000000000024727
-4.95669999999999966178
-4.98409999999999975273
-4.87830000000000030269
-4.82779999999999986926
-4.92210000000000036380
-4.94099999999999983658
-4.92330000000000023164
-4.92879999999999984794
-4.92820000000000035811
-5.04009999999999980247
-4.85160000000000035669
-4.93430000000000035243
-4.91809999999999991616
-5.03490000000000037517
-4.88579999999999969873
-4.77580000000000026716
-4.70040000000000013358
-5.00440000000000040359
-4.97689999999999965752
-4.97569999999999978968
-4.98460000000000036380
-4.84090000000000042490
-4.90200000000000013500
-4.83330000000000037375
-4.78880000000000016769
-4.92689999999999983515
-4.90760000000000040643
-4.90050000000000007816
-4.90460000000000029274
-4.85609999999999963904
-4.81210000000000004405
-4.99239999999999994884
-4.92389999999999972147
-4.93839999999999967883
-4.99819999999999975415
-4.77859999999999995879
-4.78800000000000025580
-4.75250000000000039080
-4.91859999999999963904
];
PE2 = [1.53757499999999991402
1.56552500000000005542
1.57364999999999999325
1.60159999999999991260
1.52912500000000006750
1.58307500000000000995
1.56780000000000008242
1.51872500000000010267
1.56747499999999995168
1.55220000000000002416
1.55544999999999999929
1.56844999999999989981
1.62824999999999997513
1.61687500000000006217
1.56942500000000006999
1.59250000000000002665
1.58600000000000007638
1.61947499999999999787
1.56097500000000000142
1.60614999999999996660
1.57885000000000008669
1.55154999999999998472
1.59412500000000001421
1.57820000000000004725
1.51027500000000003411
1.59315000000000006608
1.57982500000000003482
1.59022499999999999964
1.53659999999999996589
1.61102499999999992930
1.55285000000000006359
1.54895000000000004903
1.59509999999999996234
1.59640000000000004121
1.55512500000000009059
1.58079999999999998295
1.55675000000000007816
1.57430000000000003268
1.50865000000000004654
1.55382500000000001172
1.56584999999999996412
1.56390000000000006786
1.58469999999999999751
1.57397499999999990195
1.57592500000000002025
1.63020000000000009344
1.52912500000000006750
1.53530000000000010907
1.58339999999999991864
1.58502499999999990621
1.61102499999999992930
1.55089999999999994529
1.61817499999999991900
1.56844999999999989981
1.55739999999999989555
1.55707499999999998685
1.62369999999999992113
1.51905000000000001137
1.52912500000000006750
1.58860000000000001208
1.52457500000000001350
1.57430000000000003268
1.60159999999999991260
1.48817500000000002558
1.59834999999999993747
1.64840000000000008740
1.55285000000000006359
1.57527499999999998082
1.61947499999999999787
1.51255000000000006111
1.62434999999999996056
1.52977500000000010694
1.60517500000000001847
1.62532499999999990870
1.60030000000000005578
1.61785000000000001030
1.55739999999999989555
1.53204999999999991189
1.56325000000000002842
1.55544999999999999929
1.57787499999999991651
1.62630000000000007887
1.56715000000000004299
1.53887499999999999289
1.58990000000000009095
1.54862499999999991829
1.59640000000000004121
1.52847500000000002807
1.56519999999999992468
1.59769999999999989804
1.56650000000000000355
1.56877500000000003055
1.52944999999999997620
1.58697500000000002451
1.57202500000000000568
1.59509999999999996234
1.50052500000000010871
1.55902500000000010516
1.59705000000000008065
1.56812499999999999112
];
KE2avg = mean(KE2);
PE2avg = mean(PE2);
sum2 = KE2avg + PE2avg

%U = 5.5
KE3  = [-3.93699999999999983302
-4.19749999999999978684
-4.29370000000000029416
-4.42830000000000012506
-4.30400000000000027001
-4.27430000000000021032
-4.17279999999999962057
-4.20239999999999991331
-4.32050000000000000711
-4.24369999999999958362
-4.43029999999999990479
-4.37450000000000027711
-4.33349999999999990763
-4.18660000000000032117
-4.15150000000000041211
-4.33689999999999997726
-4.16329999999999955662
-4.22440000000000015490
-4.17649999999999987921
-4.42250000000000031974
-4.11739999999999994884
-4.21950000000000002842
-4.31609999999999960352
-4.30850000000000044054
-4.16340000000000021174
-4.26839999999999974989
-4.35480000000000000426
-4.07029999999999958504
-4.29830000000000023164
-4.22470000000000034390
-4.39309999999999956088
-4.44050000000000011369
-4.33530000000000015348
-4.36639999999999961489
-4.17790000000000016911
-4.10630000000000006111
-4.10329999999999994742
-4.09170000000000033680
-4.21820000000000039364
-4.22649999999999970157
-4.29900000000000037659
-4.12000000000000010658
-4.31989999999999962910
-4.24770000000000003126
-4.39250000000000007105
-4.41319999999999978968
-4.39409999999999989484
-4.33110000000000017195
-4.01480000000000014637
-4.26550000000000029132
-4.37349999999999994316
-4.30499999999999971578
-4.36709999999999975984
-4.17429999999999967741
-4.35839999999999960778
-4.18639999999999989910
-4.22919999999999962625
-4.25769999999999981810
-4.37650000000000005684
-4.11720000000000041496
-4.20720000000000027285
-4.26349999999999962341
-4.26480000000000014637
-4.16190000000000015490
-4.26600000000000001421
-4.32680000000000042348
-4.35949999999999970868
-4.33999999999999985789
-4.33450000000000024158
-4.32669999999999976836
-4.27240000000000019753
-4.50000000000000000000
-4.36650000000000027001
-4.38740000000000041069
-4.36479999999999979110
-4.33140000000000036096
-4.19350000000000022737
-4.14850000000000029843
-4.39850000000000029843
-4.26440000000000019043
-4.20629999999999970584
-4.14449999999999985079
-4.22599999999999997868
-4.34550000000000036238
-4.41439999999999965752
-4.18430000000000035243
-4.07040000000000024016
-4.15099999999999980105
-4.11950000000000038369
-4.05649999999999977263
-4.19930000000000003268
-4.07760000000000033538
-4.17729999999999979110
-4.47440000000000015490
-4.41429999999999989058
-4.38030000000000008242
-4.31479999999999996874
-4.08800000000000007816
-4.17550000000000043343
-4.16450000000000031264
];
PE3 = [1.67914999999999992042
1.88155000000000005578
1.87660000000000004583
1.89034999999999997478
1.93985000000000007425
1.82050000000000000711
1.74405000000000010019
1.75504999999999999893
1.85129999999999994564
1.85569999999999990514
1.79079999999999994742
1.84359999999999990550
1.87494999999999989448
1.82875000000000009770
1.73029999999999994920
1.79410000000000002807
1.78970000000000006857
1.79410000000000002807
1.78364999999999995772
1.95140000000000002345
1.79245000000000009877
1.78859999999999996767
1.87440000000000006608
1.83810000000000006715
1.79134999999999999787
1.82545000000000001705
1.83095000000000007745
1.80344999999999999751
1.84854999999999991545
1.84139999999999992575
1.87549999999999994493
1.83479999999999998650
1.88925000000000009592
1.82160000000000010800
1.86670000000000002593
1.77760000000000006892
1.78144999999999997797
1.78200000000000002842
1.78695000000000003837
1.72094999999999997975
1.83535000000000003695
1.82764999999999999680
1.84965000000000001634
1.77594999999999991758
1.92555000000000009486
1.85899999999999998579
1.90795000000000003482
1.78420000000000000817
1.71599999999999996980
1.80564999999999997726
1.86779999999999990479
1.88595000000000001528
1.84250000000000002665
1.75009999999999998899
1.87054999999999993499
1.94150000000000000355
1.85624999999999995559
1.77154999999999995808
1.95415000000000005365
1.70500000000000007105
1.80400000000000004796
1.82709999999999994635
1.85844999999999993534
1.78475000000000005862
1.79245000000000009877
1.82820000000000004725
1.89805000000000001492
1.82214999999999993641
1.86505000000000009663
1.89969999999999994422
1.86505000000000009663
1.90850000000000008527
1.84909999999999996589
1.85184999999999999609
1.84909999999999996589
1.81939999999999990621
1.80840000000000000746
1.79574999999999995737
1.90355000000000007532
1.90464999999999995417
1.72589999999999998970
1.74679999999999990834
1.78639999999999998792
1.76330000000000008953
1.77265000000000005898
1.79574999999999995737
1.63680000000000003268
1.73304999999999997939
1.85020000000000006679
1.81885000000000007780
1.81719999999999992646
1.83479999999999998650
1.73524999999999995914
1.84139999999999992575
1.92555000000000009486
1.86559999999999992504
1.88539999999999996483
1.76770000000000004903
1.80564999999999997726
1.82875000000000009770
];
KE3avg = mean(KE3);
PE3avg = mean(PE3);
sum3 = KE3avg + PE3avg

%U = 7.75
KE4  = [-3.23439999999999994174
-3.43730000000000002203
-3.58429999999999981952
-3.38920000000000021245
-3.60809999999999986287
-3.32759999999999989129
-3.53880000000000016769
-3.38649999999999984368
-3.38479999999999980886
-3.45109999999999983444
-3.32270000000000020890
-3.60789999999999988489
-3.66630000000000011440
-3.57319999999999993179
-3.38899999999999979039
-3.63839999999999985647
-3.47699999999999986855
-3.60099999999999997868
-3.75919999999999987494
-3.36089999999999999858
-3.59940000000000015490
-3.63779999999999992255
-3.56130000000000013216
-3.64610000000000011866
-3.68480000000000007532
-3.59870000000000000995
-3.45769999999999999574
-3.55430000000000001492
-3.67300000000000004263
-3.53980000000000005755
-3.40779999999999994031
-3.51100000000000012079
-3.60780000000000011795
-3.51960000000000006182
-3.65790000000000015135
-3.47310000000000007603
-3.42169999999999996376
-3.53140000000000009450
-3.50190000000000001279
-3.31230000000000002203
-3.36509999999999998010
-3.41049999999999986500
-3.53379999999999983018
-3.39880000000000004334
-3.37599999999999988987
-3.57960000000000011511
-3.82209999999999983089
-3.56510000000000015774
-3.60910000000000019682
-3.72089999999999987423
-3.53759999999999985576
-3.65379999999999993676
-3.53379999999999983018
-3.47380000000000022098
-3.46150000000000002132
-3.54039999999999999147
-3.39769999999999994245
-3.55839999999999978542
-3.47580000000000000071
-3.31619999999999981455
-3.43570000000000019824
-3.55540000000000011582
-3.63549999999999995381
-3.31239999999999978897
-3.42379999999999995453
-3.72670000000000012363
-3.51319999999999987850
-3.58559999999999989839
-3.48179999999999978400
-3.62329999999999996518
-3.59010000000000006892
-3.27240000000000019753
-3.59870000000000000995
-3.48700000000000009948
-3.52939999999999987068
-3.77570000000000005613
-3.62539999999999995595
-3.56289999999999995595
-3.58049999999999979394
-3.63039999999999984936
-3.57779999999999986926
-3.50689999999999990621
-3.39049999999999984723
-3.58849999999999980105
-3.38680000000000003268
-3.34640000000000004121
-3.56570000000000009166
-3.55739999999999989555
-3.45279999999999986926
-3.52490000000000014424
-3.34859999999999979892
-3.37749999999999994671
-3.85150000000000014566
-3.39990000000000014424
-3.53140000000000009450
-3.61960000000000015064
-3.58959999999999990195
-3.57810000000000005826
-3.39650000000000007461
-3.47509999999999985576
];
PE4 = [1.58099999999999996092
1.59417499999999989768
1.60037500000000010303
1.59650000000000003020
1.73832499999999989804
1.65694999999999992291
1.61897500000000005294
1.57170000000000009699
1.62440000000000006608
1.75227500000000002700
1.62362500000000009592
1.65462500000000001243
1.74530000000000007354
1.75615000000000009983
1.58875000000000010658
1.67632500000000006501
1.66314999999999990621
1.67012500000000008171
1.83519999999999994245
1.52519999999999988916
1.73987500000000006040
1.63757500000000000284
1.70112499999999999822
1.75304999999999999716
1.62517500000000003624
1.77629999999999999005
1.60657500000000008633
1.80187499999999989342
1.81582500000000002238
1.72747500000000009379
1.67090000000000005187
1.62129999999999996341
1.82434999999999991616
1.70655000000000001137
1.71740000000000003766
1.70887499999999992184
1.60115000000000007319
1.68097500000000010800
1.71429999999999993499
1.61820000000000008278
1.65307500000000007212
1.70887499999999992184
1.70655000000000001137
1.58642499999999997407
1.58875000000000010658
1.75615000000000009983
1.87162500000000009415
1.71352499999999996483
1.72669999999999990159
1.80574999999999996625
1.66005000000000002558
1.84682499999999993889
1.73677499999999995772
1.70189999999999996838
1.77862499999999990052
1.70035000000000002807
1.64454999999999995630
1.73754999999999992788
1.67012500000000008171
1.59107500000000001705
1.63757500000000000284
1.69802499999999989555
1.74607500000000004370
1.55232499999999995488
1.69104999999999994209
1.74762499999999998401
1.73910000000000009024
1.76932500000000003659
1.80807500000000009877
1.82745000000000001883
1.66857499999999991935
1.54380000000000006111
1.80807500000000009877
1.65539999999999998259
1.66857499999999991935
1.65850000000000008527
1.76312500000000005329
1.62905000000000010907
1.79180000000000005933
1.82202500000000000568
1.69802499999999989555
1.63292499999999995985
1.62052499999999999325
1.67244999999999999218
1.56162500000000004086
1.51822499999999993570
1.85922499999999990550
1.69569999999999998508
1.73599999999999998757
1.74685000000000001386
1.59572500000000006004
1.56317499999999998117
1.78869999999999995666
1.66857499999999991935
1.78560000000000007603
1.79180000000000005933
1.82125000000000003553
1.76312500000000005329
1.72437499999999999112
1.73290000000000010694
];
KE4avg = mean(KE4);
PE4avg = mean(PE4);
sum4 = KE4avg + PE4avg

%U = 10
KE5  = [-2.81159999999999987708
-2.68109999999999981668
-2.89979999999999993321
-2.95489999999999986002
-2.71099999999999985434
-2.84730000000000016414
-3.06440000000000001279
-2.89630000000000009663
-2.89509999999999978471
-2.87639999999999984581
-3.10020000000000006679
-2.97169999999999978613
-2.81210000000000004405
-2.64840000000000008740
-2.90399999999999991473
-2.99140000000000005898
-2.69580000000000019611
-2.79599999999999981881
-2.71430000000000015703
-3.06950000000000011724
-3.08800000000000007816
-2.72929999999999983729
-2.71879999999999988347
-3.05330000000000012506
-2.89210000000000011511
-2.92180000000000017479
-2.77800000000000002487
-2.89389999999999991687
-2.84319999999999994955
-2.82560000000000011156
-2.78759999999999985576
-2.82460000000000022169
-2.78489999999999993108
-3.03180000000000005045
-2.96859999999999990550
-2.77850000000000019185
-2.91529999999999978044
-2.88079999999999980531
-2.95650000000000012790
-2.81040000000000000924
-2.88010000000000010445
-2.94770000000000020890
-2.83890000000000020108
-2.80589999999999983871
-2.82319999999999993179
-2.71119999999999983231
-2.90220000000000011298
-2.82750000000000012434
-2.97560000000000002274
-2.91650000000000009237
-2.80330000000000012506
-2.75220000000000020179
-2.85599999999999987210
-2.99869999999999992113
-2.89349999999999996092
-2.91950000000000020606
-2.79269999999999996021
-2.79490000000000016200
-2.95449999999999990408
-2.90940000000000020819
-2.73470000000000013074
-2.69589999999999996305
-2.90339999999999998082
-2.86269999999999980034
-2.69640000000000013003
-2.91509999999999980247
-2.68940000000000001279
-3.04439999999999999503
-2.74860000000000015419
-2.90370000000000016982
-2.85300000000000020250
-2.84739999999999993108
-3.01060000000000016485
-2.83139999999999991687
-3.02629999999999999005
-2.71039999999999992042
-2.70429999999999992610
-3.01549999999999984723
-2.88600000000000012079
-2.70389999999999997016
-2.90099999999999980105
-2.78160000000000007248
-2.78460000000000018616
-3.04820000000000002061
-2.98229999999999995097
-2.95449999999999990408
-2.88149999999999995026
-2.76670000000000015916
-2.82259999999999999787
-2.79300000000000014921
-3.04630000000000000782
-2.95570000000000021600
-2.87250000000000005329
-2.62400000000000011013
-2.77890000000000014779
-2.79499999999999992895
-3.01869999999999993889
-2.71410000000000017906
-2.86689999999999978186
-2.97489999999999987779
];
PE5 = [1.46599999999999996980
1.33899999999999996803
1.39599999999999990763
1.52400000000000002132
1.28499999999999992006
1.46399999999999996803
1.52600000000000002309
1.39599999999999990763
1.36000000000000009770
1.39399999999999990585
1.56200000000000005507
1.44599999999999995204
1.43100000000000004974
1.35400000000000009237
1.38100000000000000533
1.45700000000000007283
1.33699999999999996625
1.34400000000000008349
1.39599999999999990763
1.61800000000000010481
1.47399999999999997691
1.37799999999999989164
1.35000000000000008882
1.51000000000000000888
1.30899999999999994138
1.60699999999999998401
1.38900000000000001243
1.44500000000000006217
1.36400000000000010125
1.54200000000000003730
1.36600000000000010303
1.42399999999999993250
1.44500000000000006217
1.43500000000000005329
1.46199999999999996625
1.51400000000000001243
1.51000000000000000888
1.33099999999999996092
1.45199999999999995737
1.36400000000000010125
1.41900000000000003908
1.52800000000000002487
1.43700000000000005507
1.41199999999999992184
1.54299999999999992717
1.32299999999999995381
1.45599999999999996092
1.45599999999999996092
1.45700000000000007283
1.49199999999999999289
1.39700000000000001954
1.38599999999999989875
1.42599999999999993427
1.41500000000000003553
1.40999999999999992006
1.39999999999999991118
1.37500000000000000000
1.29200000000000003730
1.52499999999999991118
1.45300000000000006928
1.34499999999999997335
1.36800000000000010481
1.37700000000000000178
1.33000000000000007105
1.41300000000000003375
1.46500000000000007994
1.35299999999999998046
1.60299999999999998046
1.30899999999999994138
1.52200000000000001954
1.53899999999999992362
1.40999999999999992006
1.46300000000000007816
1.49599999999999999645
1.49599999999999999645
1.41799999999999992717
1.39199999999999990408
1.45799999999999996270
1.59099999999999996980
1.33099999999999996092
1.39500000000000001776
1.38700000000000001066
1.35800000000000009592
1.62999999999999989342
1.49199999999999999289
1.49500000000000010658
1.37900000000000000355
1.25699999999999989519
1.45500000000000007105
1.30600000000000004974
1.58400000000000007461
1.52200000000000001954
1.42300000000000004263
1.30699999999999993960
1.38900000000000001243
1.42300000000000004263
1.58000000000000007105
1.32200000000000006395
1.36699999999999999289
1.48100000000000009415
];
KE5avg = mean(KE5);
PE5avg = mean(PE5);
sum5 = KE5avg + PE5avg

sum_values = [sum0, sum1, sum2, sum3, sum4, sum5];

%Find standard deiation which will be used as error bars
KE0std = std(KE0);
KE1std = std(KE1);
KE2std = std(KE2);
KE3std = std(KE3);
KE4std = std(KE4);
KE5std = std(KE5);

PE0std = std(PE0);
PE1std = std(PE1);
PE2std = std(PE2);
PE3std = std(PE3);
PE4std = std(PE4);
PE5std = std(PE5);

totalstd0 = sqrt(KE0std^2 + PE0std^2);
totalstd1 = sqrt(KE1std^2 + PE1std^2);
totalstd2 = sqrt(KE2std^2 + PE2std^2);
totalstd3 = sqrt(KE3std^2 + PE3std^2);
totalstd4 = sqrt(KE4std^2 + PE4std^2);
totalstd5 = sqrt(KE5std^2 + PE5std^2);
totalstd = [totalstd0, totalstd1, totalstd2, totalstd3, totalstd4, totalstd5];

%Plotting the results
figure;
errorbar(U_values, sum_values, totalstd, 'x-', 'DisplayName', 'QMC Values','LineWidth', 1);
hold on;
plot(U_values, Theoretical_values, 'o', 'DisplayName', 'Theoretical Values','LineWidth', 2);
hold on;
xlabel('U/J');
ylabel('Energy');
title('Comparison of Theoretical 2x2 and QMC Values for L=N=3,U'' = 1000, beta = 5');
legend('Location', 'southeast'); % Set the legend location to bottom right

