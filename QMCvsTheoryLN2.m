% Ryland Ross June 2024
% Code to graphicaly compare the calculated ground state for 2 bosons on 2
% site Bose Hubbard to the values from Julia QMC
%% Theoretical calculated
clc; clear all; close all

% Define the values of U
U_values = linspace(1, 10, 5);
% Define J
J = 2; %Set to 2 to account for double counting in 2 site situation
% Initialize an array to store the theoretical values
Theoretical_values = zeros(1, length(U_values));

% Calculate the theoretical values for each U
for i = 1:length(U_values)
    U = U_values(i);
    Theoretical_values(i) = (1/2) * (U - sqrt(16*J^2 + U^2));
end

% Display the results
disp('U values:');
disp(U_values);
disp('Theoretical values:');
disp(Theoretical_values);

%% Experimental (QMC code) values
%For U = 1
KE1  = [-3.77450000000000018829
-3.95800000000000018474
-3.92949999999999999289
-4.16800000000000014921
-3.83199999999999985079
-3.83650000000000002132
-4.12950000000000017053
-3.89349999999999996092
-3.96300000000000007816
-3.80849999999999999645
-4.10700000000000020606
-3.83749999999999991118
-3.95049999999999990052
-3.80500000000000015987
-3.96300000000000007816
-4.09299999999999997158
-4.01750000000000007105
-3.93699999999999983302
-4.01349999999999962341
-3.86149999999999993250
-3.96950000000000002842
-3.97299999999999986500
-4.13799999999999990052
-3.90750000000000019540
-4.02400000000000002132
-3.96550000000000002487
-3.99049999999999993605
-3.98150000000000003908
-3.99049999999999993605
-4.03599999999999958789
-4.25549999999999961631
-3.89749999999999996447
-4.02149999999999963052
-4.12999999999999989342
-3.93900000000000005684
-4.11399999999999987921
-4.08399999999999963052
-3.96950000000000002842
-3.92050000000000009592
-4.01449999999999995737
-3.80949999999999988631
-4.22799999999999975842
-3.85650000000000003908
-3.92600000000000015632
-4.29849999999999976552
-4.15449999999999963762
-3.80049999999999998934
-3.93599999999999994316
-3.87999999999999989342
-4.08849999999999980105
-4.12549999999999972289
-3.85150000000000014566
-3.97449999999999992184
-3.79999999999999982236
-3.84200000000000008171
-4.00349999999999983658
-4.10500000000000042633
-4.18499999999999960920
-4.07399999999999984368
-3.66800000000000014921
-4.10500000000000042633
-3.87849999999999983658
-4.20399999999999973710
-3.94749999999999978684
-3.97100000000000008527
-3.83899999999999996803
-4.05100000000000015632
-3.94050000000000011369
-4.03000000000000024869
-3.90850000000000008527
-3.88700000000000001066
-4.27249999999999996447
-3.85099999999999997868
-4.03049999999999997158
-3.97599999999999997868
-3.73749999999999982236
-3.76900000000000012790
-4.03650000000000019895
-4.03549999999999986500
-3.69300000000000006040
-4.02050000000000018474
-3.92450000000000009948
-4.06649999999999955946
-3.74800000000000022027
-3.79649999999999998579
-3.86450000000000004619
-4.12650000000000005684
-4.14599999999999990763
-4.00349999999999983658
-4.31250000000000000000
-4.26999999999999957367
-4.08950000000000013500
-4.05199999999999960210
-4.16999999999999992895
-3.97650000000000014566
-3.76350000000000006750
-3.71550000000000002487
-3.80500000000000015987
-3.99299999999999988276
-3.76200000000000001066
];
PE1 = [0.43359999999999998543
0.44169999999999998153
0.43619999999999997664
0.43959999999999999076
0.43309999999999998499
0.44000000000000000222
0.44779999999999997584
0.44150000000000000355
0.42940000000000000391
0.43719999999999997753
0.44219999999999998197
0.44690000000000001945
0.43030000000000001581
0.44429999999999997273
0.43469999999999997531
0.44100000000000000311
0.44259999999999999343
0.43020000000000002682
0.42899999999999999245
0.44759999999999999787
0.44509999999999999565
0.43540000000000000924
0.44080000000000002514
0.43890000000000001235
0.43290000000000000702
0.43559999999999998721
0.44879999999999997673
0.44130000000000002558
0.43930000000000002380
0.44790000000000002034
0.44009999999999999121
0.43169999999999997264
0.44309999999999999387
0.44409999999999999476
0.45169999999999999041
0.45760000000000000675
0.42599999999999998979
0.44519999999999998463
0.43850000000000000089
0.44000000000000000222
0.44140000000000001457
0.43269999999999997353
0.43609999999999998765
0.44040000000000001368
0.46439999999999997948
0.45540000000000002700
0.44230000000000002647
0.43290000000000000702
0.44050000000000000266
0.45150000000000001243
0.44550000000000000711
0.43490000000000000879
0.43599999999999999867
0.42880000000000001448
0.45119999999999998996
0.45519999999999999352
0.43830000000000002292
0.44779999999999997584
0.44679999999999997495
0.43330000000000001847
0.43750000000000000000
0.44609999999999999654
0.45369999999999999218
0.43109999999999998321
0.43859999999999998987
0.45650000000000001688
0.44629999999999997451
0.44409999999999999476
0.44379999999999997229
0.43349999999999999645
0.44979999999999997762
0.42859999999999998099
0.43680000000000002158
0.43880000000000002336
0.44650000000000000799
0.43840000000000001190
0.43549999999999999822
0.42980000000000001537
0.44009999999999999121
0.43609999999999998765
0.44300000000000000488
0.44550000000000000711
0.44490000000000001767
0.43680000000000002158
0.43369999999999997442
0.44629999999999997451
0.44700000000000000844
0.43759999999999998899
0.43809999999999998943
0.45010000000000000009
0.43190000000000000613
0.44490000000000001767
0.44779999999999997584
0.45500000000000001554
0.43280000000000001803
0.43430000000000001936
0.44219999999999998197
0.43330000000000001847
0.44809999999999999831
0.43109999999999998321
];
KE1avg = mean(KE1); 
PE1avg = mean(PE1);
sum1 = KE1avg + PE1avg;

%U = 3.25
KE2  = [-3.53399999999999980815
-3.53149999999999986144
-3.71950000000000002842
-3.73249999999999992895
-3.68500000000000005329
-3.47149999999999980815
-3.54850000000000020961
-3.68500000000000005329
-3.69099999999999983658
-3.90450000000000008171
-3.59050000000000002487
-3.61500000000000021316
-3.43949999999999977973
-3.77450000000000018829
-3.87049999999999982947
-3.66250000000000008882
-3.63450000000000006395
-3.78049999999999997158
-3.52099999999999990763
-3.84399999999999986144
-3.73200000000000020606
-3.61450000000000004619
-3.57750000000000012434
-3.88350000000000017408
-3.64000000000000012434
-3.57549999999999990052
-3.61500000000000021316
-4.04049999999999975842
-3.79300000000000014921
-3.83999999999999985789
-3.74250000000000015987
-3.76799999999999979394
-3.58099999999999996092
-3.79099999999999992539
-3.79649999999999998579
-3.65549999999999997158
-3.78200000000000002842
-3.82500000000000017764
-3.68100000000000004974
-3.62800000000000011369
-3.79400000000000003908
-3.63799999999999990052
-3.69749999999999978684
-3.69300000000000006040
-3.82149999999999989697
-3.63899999999999979039
-3.66800000000000014921
-3.79499999999999992895
-3.94649999999999989697
-3.87849999999999983658
-3.50749999999999984013
-3.83099999999999996092
-3.72999999999999998224
-3.75749999999999984013
-3.72049999999999991829
-3.73850000000000015632
-3.73249999999999992895
-3.72149999999999980815
-3.61100000000000020961
-3.72549999999999981171
-3.62500000000000000000
-3.89650000000000007461
-3.73249999999999992895
-3.75000000000000000000
-3.54150000000000009237
-3.88200000000000011724
-3.48649999999999993250
-3.82050000000000000711
-3.57350000000000012079
-3.83650000000000002132
-3.61350000000000015632
-3.52199999999999979750
-3.78350000000000008527
-3.86549999999999993605
-3.64400000000000012790
-3.57450000000000001066
-3.68299999999999982947
-3.72949999999999981526
-3.86450000000000004619
-3.61649999999999982592
-3.77199999999999979750
-3.66500000000000003553
-3.57299999999999995381
-3.77899999999999991473
-3.84299999999999997158
-3.71200000000000018829
-3.76100000000000012079
-3.67350000000000020961
-3.59549999999999991829
-3.60950000000000015277
-3.96899999999999986144
-3.59149999999999991473
-3.59750000000000014211
-3.80100000000000015632
-3.68849999999999988987
-3.72000000000000019540
-3.59750000000000014211
-3.71550000000000002487
-3.70250000000000012434
-3.56300000000000016698
];
PE2 = [0.99352499999999999147
0.97857499999999997264
1.01465000000000005187
1.02829999999999999183
1.02374999999999993783
1.00587500000000007461
1.01009999999999999787
1.06404999999999994031
0.99319999999999997176
1.04715000000000002522
1.03057500000000001883
0.98409999999999997478
1.02472500000000010800
1.03577499999999989022
1.01042499999999990656
1.00229999999999996874
1.03447500000000003340
1.00262500000000009948
1.04747499999999993392
1.04780000000000006466
1.03187500000000009770
1.03382499999999999396
1.04000000000000003553
1.00847500000000001030
1.01594999999999990870
1.00652499999999989200
0.98052499999999997993
1.08062499999999994671
1.06567499999999992788
1.04584999999999994635
1.03967499999999990479
1.05722500000000008136
0.99580000000000001847
1.01400000000000001243
1.01984999999999992326
1.00425000000000008704
0.99807500000000004547
1.01367500000000010374
1.00912500000000004974
1.04325000000000001066
1.03967499999999990479
1.02017500000000005400
1.03772500000000000853
1.02212499999999995026
1.02862499999999990052
1.03187500000000009770
1.04780000000000006466
1.08452499999999996128
0.99417500000000003091
1.03350000000000008527
0.98604999999999998206
1.05527499999999996305
1.04617500000000007709
1.06859999999999999432
1.04487499999999999822
1.01594999999999990870
1.04519999999999990692
1.00425000000000008704
1.02147499999999991083
1.01237500000000002487
1.00652499999999989200
1.07444999999999990514
1.03382499999999999396
1.04129999999999989235
1.00457499999999999574
1.02699999999999991296
1.02342500000000002913
1.02407500000000006857
1.03707499999999996909
1.03544999999999998153
1.04974999999999996092
1.01075000000000003730
1.00782499999999997087
1.03057500000000001883
0.99904999999999999361
1.02180000000000004157
1.02439999999999997726
1.02960000000000007070
1.07867500000000005045
1.05885000000000006892
1.04065000000000007496
1.00229999999999996874
1.01855000000000006644
1.04065000000000007496
1.01659999999999994813
1.04129999999999989235
1.00262500000000009948
1.04065000000000007496
1.02309999999999989839
1.05072499999999990905
1.04552500000000003766
0.97889999999999999236
1.01075000000000003730
1.01465000000000005187
1.01465000000000005187
1.05267500000000002736
1.03967499999999990479
1.07705000000000006288
1.06794999999999995488
1.02245000000000008100
];
KE2avg = mean(KE2);
PE2avg = mean(PE2);
sum2 = KE2avg + PE2avg;

%U = 5.5
KE3  = [-3.23950000000000004619
-3.28100000000000013856
-3.26250000000000017764
-3.25800000000000000711
-3.50899999999999989697
-3.26250000000000017764
-3.42099999999999981881
-2.89950000000000018829
-3.21600000000000019185
-3.17600000000000015632
-3.23450000000000015277
-3.38149999999999995026
-3.19349999999999978328
-3.38050000000000006040
-3.50999999999999978684
-3.39699999999999979750
-3.16749999999999998224
-3.29300000000000014921
-3.31899999999999995026
-3.19099999999999983658
-3.12449999999999983302
-3.45849999999999990763
-3.44950000000000001066
-3.25749999999999984013
-3.27649999999999996803
-3.37999999999999989342
-3.23349999999999981881
-3.38450000000000006395
-3.31150000000000011013
-3.26049999999999995381
-3.25649999999999995026
-3.44550000000000000711
-3.41250000000000008882
-3.17099999999999981881
-3.49549999999999982947
-3.24750000000000005329
-3.34249999999999980460
-3.32450000000000001066
-3.35000000000000008882
-3.17649999999999987921
-3.59500000000000019540
-3.27850000000000019185
-3.11500000000000021316
-3.42750000000000021316
-3.22000000000000019540
-3.32500000000000017764
-3.44099999999999983658
-3.38600000000000012079
-3.36249999999999982236
-3.32799999999999984723
-3.33400000000000007461
-3.12849999999999983658
-3.26949999999999985079
-3.15649999999999986144
-3.34699999999999997513
-3.41800000000000014921
-3.28750000000000008882
-3.30549999999999988276
-3.30750000000000010658
-3.19349999999999978328
-3.51250000000000017764
-3.25999999999999978684
-3.35599999999999987210
-3.36200000000000009948
-3.24100000000000010303
-3.37849999999999983658
-3.42899999999999982592
-3.42600000000000015632
-3.22699999999999986855
-3.47049999999999991829
-3.40750000000000019540
-3.36949999999999993960
-3.27649999999999996803
-3.34249999999999980460
-3.45449999999999990408
-3.41199999999999992184
-3.33999999999999985789
-3.16999999999999992895
-3.19349999999999978328
-3.23649999999999993250
-3.28799999999999981171
-3.54349999999999987210
-3.18999999999999994671
-3.23799999999999998934
-3.30900000000000016342
-3.21399999999999996803
-3.33300000000000018474
-3.14900000000000002132
-3.12900000000000000355
-3.18900000000000005684
-3.24549999999999982947
-3.34549999999999991829
-3.52700000000000013500
-3.13050000000000006040
-3.27050000000000018474
-3.23300000000000009592
-3.38949999999999995737
-3.32799999999999984723
-3.39100000000000001421
-3.04599999999999981881
];
PE3 = [1.18140000000000000568
1.22980000000000000426
1.26665000000000005365
1.19680000000000008598
1.23639999999999994351
1.19680000000000008598
1.27709999999999990195
1.16765000000000007674
1.19019999999999992468
1.22154999999999991367
1.14894999999999991580
1.23750000000000004441
1.18524999999999991473
1.22869999999999990337
1.21110000000000006537
1.25839999999999996305
1.19900000000000006573
1.18744999999999989448
1.24685000000000001386
1.15224999999999999645
1.14070000000000004725
1.23199999999999998401
1.24629999999999996341
1.18799999999999994493
1.24134999999999995346
1.21164999999999989377
1.15500000000000002665
1.25564999999999993285
1.21714999999999995417
1.21825000000000005507
1.22320000000000006501
1.21055000000000001492
1.24685000000000001386
1.19130000000000002558
1.25400000000000000355
1.17094999999999993534
1.14290000000000002700
1.24685000000000001386
1.22154999999999991367
1.13464999999999993641
1.25180000000000002380
1.20504999999999995453
1.18910000000000004583
1.24025000000000007461
1.19074999999999997513
1.15775000000000005684
1.27214999999999989200
1.22980000000000000426
1.22924999999999995381
1.17260000000000008669
1.21439999999999992397
1.18029999999999990479
1.21770000000000000462
1.16985000000000005649
1.16050000000000008704
1.25015000000000009450
1.16985000000000005649
1.22704999999999997407
1.18910000000000004583
1.20724999999999993427
1.22209999999999996412
1.18854999999999999538
1.16215000000000001634
1.21494999999999997442
1.17534999999999989484
1.20560000000000000497
1.24190000000000000391
1.22429999999999994387
1.18359999999999998543
1.25400000000000000355
1.24190000000000000391
1.21385000000000009557
1.18084999999999995524
1.24740000000000006430
1.20615000000000005542
1.28039999999999998259
1.22980000000000000426
1.12749999999999994671
1.19130000000000002558
1.21164999999999989377
1.21164999999999989377
1.28754999999999997229
1.17369999999999996554
1.13300000000000000711
1.19074999999999997513
1.20229999999999992433
1.24079999999999990301
1.19405000000000005578
1.14729999999999998650
1.15389999999999992575
1.26170000000000004370
1.24629999999999996341
1.18799999999999994493
1.15884999999999993570
1.15114999999999989555
1.20999999999999996447
1.23584999999999989306
1.22374999999999989342
1.23584999999999989306
1.15444999999999997620
];
KE3avg = mean(KE3);
PE3avg = mean(PE3);
sum3 = KE3avg + PE3avg;

%U = 7.75
KE4  = [-3.06849999999999978328
-2.78750000000000008882
-2.92350000000000020961
-2.73799999999999998934
-2.93849999999999988987
-2.84900000000000019895
-2.89800000000000013145
-3.20350000000000001421
-2.81400000000000005684
-2.80449999999999999289
-2.99199999999999999289
-2.79150000000000009237
-2.99699999999999988631
-2.74699999999999988631
-2.77450000000000018829
-2.89049999999999984723
-2.85800000000000009592
-3.17799999999999993605
-2.79700000000000015277
-2.83849999999999980105
-2.82949999999999990408
-2.96349999999999980105
-3.11100000000000020961
-3.08199999999999985079
-2.83700000000000018829
-3.09450000000000002842
-2.89000000000000012434
-3.17399999999999993250
-2.95049999999999990052
-2.61699999999999999289
-2.98099999999999987210
-2.78650000000000019895
-2.84200000000000008171
-2.93349999999999999645
-2.77899999999999991473
-3.04800000000000004263
-2.88249999999999984013
-2.79700000000000015277
-2.83099999999999996092
-2.98649999999999993250
-2.66349999999999997868
-2.83000000000000007105
-2.99400000000000021672
-2.93800000000000016698
-3.00349999999999983658
-3.04649999999999998579
-2.85250000000000003553
-2.93800000000000016698
-2.79199999999999981526
-2.81000000000000005329
-2.78449999999999997513
-2.93100000000000004974
-2.94200000000000017053
-2.96150000000000002132
-2.79950000000000009948
-2.93500000000000005329
-2.92450000000000009948
-2.75249999999999994671
-2.72500000000000008882
-2.84600000000000008527
-2.91250000000000008882
-2.92899999999999982592
-2.79249999999999998224
-2.85150000000000014566
-2.84299999999999997158
-2.96349999999999980105
-2.96450000000000013500
-2.87950000000000017053
-2.66349999999999997868
-2.65350000000000019185
-3.06150000000000011013
-2.87849999999999983658
-2.98349999999999981881
-3.05200000000000004619
-3.08000000000000007105
-2.95699999999999985079
-2.87950000000000017053
-2.83400000000000007461
-2.80049999999999998934
-3.05750000000000010658
-2.85199999999999986855
-2.81300000000000016698
-2.81050000000000022027
-2.82399999999999984368
-2.97100000000000008527
-2.77999999999999980460
-3.02499999999999991118
-2.68949999999999977973
-2.86350000000000015632
-2.87550000000000016698
-3.10300000000000020250
-2.82450000000000001066
-2.99049999999999993605
-3.02749999999999985789
-2.97299999999999986500
-2.82399999999999984368
-2.77499999999999991118
-2.72149999999999980815
-2.94450000000000011724
-2.98450000000000015277
];
PE4 = [1.28417500000000006644
1.12762500000000009948
1.17102499999999998259
1.11444999999999994067
1.27255000000000006999
1.17955000000000009841
1.15552499999999991331
1.23690000000000011049
1.20202499999999989910
1.18730000000000002203
1.22837499999999999467
1.13072499999999998010
1.20280000000000009130
1.15785000000000004583
1.10437500000000010658
1.11522499999999991083
1.16792500000000010196
1.27642499999999992077
1.17257499999999992291
1.16172499999999989662
1.18652500000000005187
1.21132499999999998508
1.26557499999999989448
1.21597500000000002807
1.13692499999999996341
1.21520000000000005791
1.17567500000000002558
1.32292499999999990656
1.22062500000000007105
1.08965000000000000746
1.12840000000000006963
1.09817499999999990123
1.19892500000000001847
1.28029999999999999361
1.18730000000000002203
1.25550000000000006040
1.17722499999999996589
1.13460000000000005294
1.20124999999999992895
1.21055000000000001492
1.12762500000000009948
1.04237500000000005151
1.21364999999999989555
1.23922500000000002096
1.22140000000000004121
1.22294999999999998153
1.17025000000000001243
1.22140000000000004121
1.09430000000000005045
1.14157500000000000639
1.13847499999999990372
1.26324999999999998401
1.22605000000000008420
1.18962499999999993250
1.21520000000000005791
1.24619999999999997442
1.16714999999999990976
1.15320000000000000284
1.14932499999999993001
1.14157500000000000639
1.16250000000000008882
1.18032500000000006857
1.13460000000000005294
1.17644999999999999574
1.10902499999999992752
1.16172499999999989662
1.19737500000000007816
1.16559999999999996945
1.12684999999999990727
1.12220000000000008633
1.24852500000000010694
1.17799999999999993605
1.20589999999999997193
1.17955000000000009841
1.21520000000000005791
1.19350000000000000533
1.10592500000000004690
1.16094999999999992646
1.08034999999999992149
1.26092500000000007354
1.18342499999999994920
1.17799999999999993605
1.18730000000000002203
1.13072499999999998010
1.14777499999999998970
1.14234999999999997655
1.18962499999999993250
1.16637499999999993960
1.23302500000000003766
1.16327500000000005898
1.17490000000000005542
1.17644999999999999574
1.17799999999999993605
1.27332500000000004015
1.24465000000000003411
1.12917500000000003979
1.15862500000000001599
1.22914999999999996483
1.21985000000000010090
1.25550000000000006040
];
KE4avg = mean(KE4);
PE4avg = mean(PE4);
sum4 = KE4avg + PE4avg;

%U = 10
KE5  = [-2.44850000000000012079
-2.57799999999999984723
-2.31050000000000022027
-2.10349999999999992539
-2.66150000000000019895
-2.44499999999999984013
-2.31349999999999988987
-2.66950000000000020606
-2.34100000000000019185
-2.50099999999999988987
-2.54850000000000020961
-2.52850000000000019185
-2.37699999999999977973
-2.43400000000000016342
-2.32450000000000001066
-2.54749999999999987566
-2.53549999999999986500
-2.58950000000000013500
-2.70800000000000018474
-2.44649999999999989697
-2.72250000000000014211
-2.47549999999999981171
-2.33599999999999985434
-2.40499999999999980460
-2.31349999999999988987
-2.46349999999999980105
-2.53900000000000014566
-2.47049999999999991829
-2.24049999999999993605
-2.51100000000000012079
-2.57350000000000012079
-2.45800000000000018474
-2.59350000000000013856
-2.67499999999999982236
-2.72949999999999981526
-2.50999999999999978684
-2.43100000000000004974
-2.53449999999999997513
-2.52349999999999985434
-2.66349999999999997868
-2.53500000000000014211
-2.46700000000000008171
-2.37950000000000017053
-2.59699999999999997513
-2.64500000000000001776
-2.31349999999999988987
-2.53949999999999986855
-2.52450000000000018829
-2.16000000000000014211
-2.52150000000000007461
-2.49500000000000010658
-2.48450000000000015277
-2.53049999999999997158
-2.86850000000000004974
-2.39150000000000018119
-2.50800000000000000711
-2.22250000000000014211
-2.53549999999999986500
-2.62349999999999994316
-2.36249999999999982236
-2.38350000000000017408
-2.54800000000000004263
-2.59200000000000008171
-2.85599999999999987210
-2.44300000000000006040
-2.33449999999999979750
-2.82100000000000017408
-2.48749999999999982236
-2.68900000000000005684
-2.43500000000000005329
-2.64100000000000001421
-2.50349999999999983658
-2.41199999999999992184
-2.29349999999999987210
-2.42799999999999993605
-2.57299999999999995381
-2.43800000000000016698
-2.56300000000000016698
-2.42750000000000021316
-2.61500000000000021316
-2.60000000000000008882
-2.53549999999999986500
-2.62449999999999983302
-2.61149999999999993250
-2.58449999999999979750
-2.41150000000000019895
-2.53900000000000014566
-2.54400000000000003908
-2.55399999999999982592
-2.30449999999999999289
-2.49549999999999982947
-2.60250000000000003553
-2.43199999999999993960
-2.62250000000000005329
-2.62800000000000011369
-2.46850000000000013856
-2.59149999999999991473
-2.33449999999999979750
-2.55799999999999982947
-2.39250000000000007105
];
PE5 = [1.10800000000000009592
1.13500000000000000888
1.13300000000000000711
0.98899999999999999023
1.10000000000000008882
1.00400000000000000355
1.04200000000000003730
1.12299999999999999822
1.04899999999999993250
1.10000000000000008882
1.13799999999999990052
1.20199999999999995737
1.01400000000000001243
1.09800000000000008704
1.08200000000000007283
1.06299999999999994493
1.15500000000000002665
1.11699999999999999289
1.15500000000000002665
1.09000000000000007994
1.20199999999999995737
1.07699999999999995737
1.03200000000000002842
1.07899999999999995914
1.02200000000000001954
1.15999999999999992006
1.11000000000000009770
1.04200000000000003730
0.94399999999999995026
1.04099999999999992539
1.00600000000000000533
1.06099999999999994316
1.18300000000000005151
1.19999999999999995559
1.18999999999999994671
1.06000000000000005329
1.08699999999999996625
1.09200000000000008171
1.11099999999999998757
1.12900000000000000355
1.06200000000000005507
1.12999999999999989342
1.08600000000000007638
1.06000000000000005329
1.13199999999999989519
0.95699999999999996181
1.11400000000000010125
1.11400000000000010125
0.93799999999999994493
1.09699999999999997513
1.15700000000000002842
1.11200000000000009948
1.10000000000000008882
1.24599999999999999645
1.00000000000000000000
1.15300000000000002487
1.02899999999999991473
1.09200000000000008171
1.12000000000000010658
1.09400000000000008349
1.05099999999999993427
1.17700000000000004619
1.18500000000000005329
1.18300000000000005151
1.05499999999999993783
1.06600000000000005862
1.19100000000000005862
1.03099999999999991651
1.18700000000000005507
1.08200000000000007283
1.10099999999999997868
1.10000000000000008882
1.10200000000000009059
1.04000000000000003553
1.04499999999999992895
1.11200000000000009948
1.04699999999999993072
1.10200000000000009059
1.12900000000000000355
1.16799999999999992717
1.11600000000000010303
1.08200000000000007283
1.09499999999999997335
1.12599999999999988987
1.17199999999999993072
1.07299999999999995381
1.08600000000000007638
1.05099999999999993427
1.08899999999999996803
1.04499999999999992895
1.08699999999999996625
1.08000000000000007105
1.09499999999999997335
1.10299999999999998046
1.17599999999999993427
1.09600000000000008527
1.11699999999999999289
0.98799999999999998934
1.12900000000000000355
1.04600000000000004086
];
KE5avg = mean(KE5);
PE5avg = mean(PE5);
sum5 = KE5avg + PE5avg;

sum_values = [sum1, sum2, sum3, sum4, sum5]; 
%Find standard deiation which will be used as error bars
KE1std = std(KE1);
KE2std = std(KE2);
KE3std = std(KE3);
KE4std = std(KE4);
KE5std = std(KE5);
PE1std = std(PE1);
PE2std = std(PE2);
PE3std = std(PE3);
PE4std = std(PE4);
PE5std = std(PE5);

totalstd1 = sqrt(KE1std^2 + PE1std^2);
totalstd2 = sqrt(KE2std^2 + PE2std^2);
totalstd3 = sqrt(KE3std^2 + PE3std^2);
totalstd4 = sqrt(KE4std^2 + PE4std^2);
totalstd5 = sqrt(KE5std^2 + PE5std^2);
totalstd = [totalstd1, totalstd2, totalstd3, totalstd4, totalstd5];

%% Plotting the results
figure;
errorbar(U_values, sum_values, totalstd, 'x-', 'DisplayName', 'Experimental Values with Total Error Bars');
hold on;
plot(U_values, Theoretical_values, 'o', 'DisplayName', 'Theoretical Values');
hold on;
xlabel('U Values');
ylabel('Energy');
title('Comparison of Theoretical and Experimental Values, beta = 1');
legend('Location', 'southeast'); 
grid on;
