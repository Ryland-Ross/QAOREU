%code to check QMC vs calculated ground state for L=3=N
%julia pigsfli.jl -D 1 -L 3 -N 3 -l 1 -U 1 --mu .0001 --sweeps 100000 --seed 1 --measurement-frequency 25 --bin-size 10000 --bins-wanted 100 --num-replicas 1 --beta 5.0 --canonical true

%% Theoretical calculated
clc; clear all; close all

% Define the values of U
U_values = linspace(1, 10, 5);
J = 1;
% Initialize an array to store the theoretical values
Theoretical_values = zeros(1, length(U_values));

% Calculate the theoretical values for each U
for i = 1:length(U_values)
    U = U_values(i);
    Theoretical_values(i) = real((4*U)/3 - J - ((3*J - 4*U)^2/9 + 6*J^2 - U^2 + 3*J*U)/(2*((((3*J - 4*U)^3/27 + 18*J^2*U + ((3*J - 4*U)*(18*J^2 + 9*J*U - 3*U^2))/6)^2 - ((3*J - 4*U)^2/9 + 6*J^2 - U^2 + 3*J*U)^3)^(1/2) - 18*J^2*U - ((3*J - 4*U)*(18*J^2 + 9*J*U - 3*U^2))/6 - (3*J - 4*U)^3/27)^(1/3)) - (3^(1/2)*(((3*J - 4*U)^2/9 + 6*J^2 - U^2 + 3*J*U)/((((3*J - 4*U)^3/27 + 18*J^2*U + ((3*J - 4*U)*(18*J^2 + 9*J*U - 3*U^2))/6)^2 - ((3*J - 4*U)^2/9 + 6*J^2 - U^2 + 3*J*U)^3)^(1/2) - 18*J^2*U - ((3*J - 4*U)*(18*J^2 + 9*J*U - 3*U^2))/6 - (3*J - 4*U)^3/27)^(1/3) - ((((3*J - 4*U)^3/27 + 18*J^2*U + ((3*J - 4*U)*(18*J^2 + 9*J*U - 3*U^2))/6)^2 - ((3*J - 4*U)^2/9 + 6*J^2 - U^2 + 3*J*U)^3)^(1/2) - 18*J^2*U - ((3*J - 4*U)*(18*J^2 + 9*J*U - 3*U^2))/6 - (3*J - 4*U)^3/27)^(1/3))*1i)/2 - ((((3*J - 4*U)^3/27 + 18*J^2*U + ((3*J - 4*U)*(18*J^2 + 9*J*U - 3*U^2))/6)^2 - ((3*J - 4*U)^2/9 + 6*J^2 - U^2 + 3*J*U)^3)^(1/2) - 18*J^2*U - ((3*J - 4*U)*(18*J^2 + 9*J*U - 3*U^2))/6 - (3*J - 4*U)^3/27)^(1/3)/2);
end

% Display the results
disp('U values:');
disp(U_values);
disp('Theoretical values:');
disp(Theoretical_values);

%% Experimental (code) values
%For U = 1
KE1  = [-6.17239999999999966462
-5.77890000000000014779
-5.87169999999999969731
-6.05529999999999990479
-5.80750000000000010658
-5.84870000000000000995
-5.65219999999999966889
-5.77599999999999980105
-5.95809999999999995168
-5.82040000000000024016
-5.95999999999999996447
-5.97700000000000031264
-5.95260000000000033538
-5.91429999999999989058
-5.69350000000000022737
-5.96710000000000029274
-5.86920000000000019469
-5.70340000000000024727
-5.98420000000000040785
-5.83290000000000041780
-5.95479999999999964899
-6.06679999999999974847
-5.71590000000000042490
-5.48610000000000042064
-5.84330000000000016058
-5.95300000000000029132
-5.92750000000000021316
-5.89130000000000020322
-5.95019999999999971152
-5.90139999999999975699
-5.80389999999999961489
-5.95190000000000019043
-5.93960000000000043485
-5.62230000000000007532
-5.70270000000000010232
-5.91699999999999981526
-5.76259999999999994458
-5.91709999999999958220
-5.86200000000000009948
-5.98800000000000043343
-6.05189999999999983515
-6.03659999999999996589
-6.20790000000000041780
-5.80830000000000001847
-5.98749999999999982236
-6.14949999999999974420
-5.90960000000000018616
-5.90800000000000036238
-5.77960000000000029274
-5.98050000000000014921
-5.82810000000000005826
-6.14010000000000033538
-5.99350000000000004974
-5.74099999999999965894
-6.21419999999999994600
-5.84379999999999988347
-5.77599999999999980105
-6.05459999999999975984
-5.90240000000000009095
-6.20300000000000029132
-5.93259999999999987352
-5.86760000000000037090
-5.84999999999999964473
-6.07910000000000039222
-5.97449999999999992184
-5.89419999999999966178
-6.15090000000000003411
-6.06280000000000018900
-5.96469999999999966889
-5.77369999999999983231
-5.75769999999999981810
-5.88809999999999966747
-5.88320000000000042917
-5.86249999999999982236
-5.72149999999999980815
-5.82219999999999959783
-6.11390000000000011227
-5.63959999999999972431
-5.89130000000000020322
-5.76069999999999993179
-5.85050000000000025580
-5.88830000000000008953
-5.79779999999999962057
-5.82789999999999963620
-5.71070000000000010942
-5.93780000000000018900
-5.84839999999999982094
-5.95669999999999966178
-5.60350000000000036948
-6.19650000000000034106
-5.85010000000000029985
-5.87089999999999978542
-5.79220000000000023732
-5.97780000000000022453
-5.87450000000000027711
-5.84170000000000033680
-5.83260000000000022879
-6.02799999999999958078
-5.92980000000000018190
-6.01240000000000041069];
PE1 = [0.81969999999999998419
0.83709999999999995524
0.79339999999999999414
0.84450000000000002842
0.83079999999999998295
0.83599999999999996536
0.81840000000000001634
0.82310000000000005382
0.84750000000000003109
0.80440000000000000391
0.81930000000000002824
0.80869999999999997442
0.82130000000000003002
0.86360000000000003428
0.77480000000000004423
0.83260000000000000675
0.81389999999999995683
0.78439999999999998614
0.79539999999999999591
0.83889999999999997904
0.78710000000000002185
0.82830000000000003624
0.80089999999999994529
0.79690000000000005276
0.83020000000000004903
0.80240000000000000213
0.86660000000000003695
0.77270000000000005347
0.82199999999999995293
0.87250000000000005329
0.81210000000000004405
0.85070000000000001172
0.86639999999999994795
0.82440000000000002167
0.76070000000000004281
0.78190000000000003944
0.84760000000000002007
0.87919999999999998153
0.80689999999999995062
0.78090000000000003855
0.78300000000000002931
0.79679999999999995275
0.84619999999999995222
0.81820000000000003837
0.84060000000000001386
0.84119999999999994778
0.81610000000000004761
0.82979999999999998206
0.77300000000000002043
0.78720000000000001084
0.86499999999999999112
0.82110000000000005205
0.83389999999999997460
0.82010000000000005116
0.82189999999999996394
0.82530000000000003357
0.79710000000000003073
0.87939999999999995950
0.84140000000000003677
0.85470000000000001528
0.83450000000000001954
0.83430000000000004157
0.84619999999999995222
0.87780000000000002469
0.76639999999999997016
0.85089999999999998970
0.80000000000000004441
0.81789999999999996039
0.80620000000000002771
0.84130000000000004778
0.81679999999999997051
0.81149999999999999911
0.83609999999999995435
0.82620000000000004547
0.78659999999999996589
0.79020000000000001350
0.82330000000000003180
0.74460000000000003961
0.82259999999999999787
0.85789999999999999591
0.80640000000000000568
0.84419999999999995044
0.82709999999999994635
0.79349999999999998312
0.82750000000000001332
0.78480000000000005311
0.77669999999999994600
0.82420000000000004370
0.82420000000000004370
0.85309999999999996945
0.85750000000000003997
0.80000000000000004441
0.78839999999999998970
0.78869999999999995666
0.83720000000000005524
0.86170000000000002149
0.82960000000000000409
0.83150000000000001688
0.80079999999999995630
0.79469999999999996199
];
KE1avg = mean(KE1); 
PE1avg = mean(PE1);
sum1 = KE1avg + PE1avg

%U = 3.25
KE2  = [-5.26989999999999980673
-5.31080000000000040927
-5.58769999999999988916
-5.53709999999999968878
-5.32089999999999996305
-5.47210000000000018616
-5.37040000000000006253
-5.61380000000000034532
-5.36990000000000033964
-5.27690000000000036806
-5.45859999999999967457
-5.35409999999999985931
-5.28720000000000034390
-5.40200000000000013500
-5.45490000000000030411
-5.42820000000000035811
-5.52219999999999977547
-5.25000000000000000000
-5.20610000000000017195
-5.44040000000000034674
-5.68259999999999987352
-5.23109999999999963904
-5.39670000000000005258
-5.78380000000000027427
-5.57889999999999997016
-5.56749999999999989342
-5.27479999999999993321
-5.33410000000000028564
-5.23139999999999982805
-5.47079999999999966320
-5.37579999999999991189
-5.41640000000000032543
-5.49350000000000004974
-5.49169999999999980389
-5.55949999999999988631
-5.48939999999999983515
-5.46089999999999964331
-5.23759999999999958931
-5.52609999999999956799
-5.53620000000000000995
-5.22769999999999956941
-5.43459999999999965326
-5.22109999999999985221
-5.27449999999999974420
-5.43440000000000011937
-5.40439999999999987068
-5.45070000000000032259
-5.41720000000000023732
-5.32789999999999963620
-5.16830000000000033822
-5.34659999999999957510
-5.20160000000000000142
-5.42879999999999984794
-5.37129999999999974136
-5.50150000000000005684
-5.39799999999999968736
-5.48099999999999987210
-5.17959999999999975984
-5.57000000000000028422
-5.24990000000000023306
-5.50250000000000039080
-5.16120000000000000995
-5.63689999999999979963
-5.34729999999999972005
-5.23059999999999991616
-5.37389999999999989910
-5.57089999999999996305
-5.33570000000000010942
-5.45899999999999963052
-5.25159999999999982379
-5.49699999999999988631
-5.48850000000000015632
-5.47959999999999958220
-5.66840000000000010516
-5.36369999999999969020
-5.43499999999999960920
-5.23399999999999998579
-5.16779999999999972715
-5.16319999999999978968
-5.20350000000000001421
-5.31280000000000018900
-5.33800000000000007816
-5.17619999999999969020
-5.28369999999999961915
-5.55619999999999958362
-5.30909999999999993037
-5.43459999999999965326
-5.29319999999999968310
-5.28889999999999993463
-5.46680000000000010374
-5.45870000000000032969
-5.14290000000000002700
-5.57420000000000026574
-5.39799999999999968736
-5.08570000000000010942
-5.75190000000000001279
-5.34330000000000016058
-5.31609999999999960352
-5.14090000000000024727
-5.25070000000000014495
];
PE2 = [1.82390000000000007674
1.81285000000000007248
1.95357500000000006146
1.73842500000000010907
1.80764999999999997904
1.90222500000000005471
1.85672499999999995879
1.96137500000000009059
1.78522500000000006182
1.77970000000000005969
1.82780000000000009130
1.80407500000000009521
1.83592500000000002913
1.84860000000000002096
1.88565000000000004832
1.87687500000000007105
1.77774999999999994138
1.91294999999999992824
1.71632500000000010054
1.75564999999999993285
1.81382500000000002061
1.76507499999999994955
1.88857499999999989271
1.82812500000000000000
1.70494999999999996554
1.75792499999999995985
1.75889999999999990798
1.73094999999999998863
1.79627500000000006608
1.75727499999999992042
1.85867500000000007709
1.92042500000000004867
1.91880000000000006111
1.92595000000000005080
1.87264999999999992575
1.78295000000000003482
1.89962499999999989697
1.78782499999999999751
1.86224999999999996092
1.88240000000000007319
1.70722499999999999254
1.81285000000000007248
1.68707500000000010232
1.80927499999999996660
1.83885000000000009557
1.87200000000000010836
1.99679999999999990834
1.85477500000000006253
1.80602499999999999147
1.67635000000000000675
1.84664999999999990266
1.75792499999999995985
1.83170000000000010587
1.75012499999999993072
1.90775000000000005684
1.71989999999999998437
1.93667499999999992433
1.73875000000000001776
1.80472499999999991260
1.72347500000000009024
1.85705000000000008953
1.70884999999999998010
1.93992499999999989946
1.81739999999999990443
1.80862499999999992717
1.90320000000000000284
1.85542500000000010196
1.81187499999999990230
1.72997500000000004050
1.81804999999999994387
1.86777499999999996305
1.82454999999999989413
1.85802500000000003766
1.78360000000000007425
1.76604999999999989768
1.80667500000000003091
1.82357499999999994600
1.80049999999999998934
1.70884999999999998010
1.75792499999999995985
1.83592500000000002913
1.92757500000000003837
1.79269999999999996021
1.79855000000000009308
1.97112500000000001599
1.83592500000000002913
1.82390000000000007674
1.69195000000000006501
1.67959999999999998188
1.84079999999999999183
1.89345000000000007745
1.81414999999999992930
1.88109999999999999432
1.79529999999999989591
1.78652499999999991864
1.89020000000000010232
1.73712500000000003020
1.76150000000000006573
1.72379999999999999893
1.77580000000000004512
];
KE2avg = mean(KE2);
PE2avg = mean(PE2);
sum2 = KE2avg + PE2avg

%U = 5.5
KE3  = [-4.54349999999999987210
-4.32469999999999998863
-4.59349999999999969447
-4.56930000000000013927
-4.86509999999999998010
-4.46969999999999956231
-4.62330000000000040927
-4.61939999999999972857
-4.53239999999999998437
-4.54150000000000009237
-4.50340000000000006963
-4.55869999999999997442
-4.80220000000000002416
-4.61960000000000015064
-4.65859999999999985221
-4.67849999999999965894
-4.57089999999999996305
-4.60039999999999960067
-4.43480000000000007532
-4.45699999999999985079
-4.50039999999999995595
-4.56780000000000008242
-4.23880000000000034532
-4.58209999999999961773
-4.25760000000000005116
-4.64240000000000030411
-4.81430000000000024585
-4.54940000000000033253
-4.38719999999999998863
-4.51320000000000032259
-4.62560000000000037801
-4.52160000000000028564
-4.55400000000000027001
-4.47050000000000036238
-4.54459999999999997300
-4.57319999999999993179
-4.66399999999999970157
-4.85039999999999960067
-4.35799999999999965183
-4.48310000000000030695
-4.34940000000000015490
-4.37549999999999972289
-4.62220000000000030838
-4.56179999999999985505
-4.49150000000000027001
-4.58670000000000044338
-4.46570000000000000284
-4.50940000000000029701
-4.67720000000000002416
-4.61270000000000024443
-4.38220000000000009521
-4.42060000000000030695
-4.67499999999999982236
-4.51520000000000010232
-4.61899999999999977263
-4.62659999999999982379
-4.79530000000000011795
-4.69650000000000034106
-4.58849999999999980105
-4.24870000000000036522
-4.53969999999999984652
-4.45629999999999970584
-4.71039999999999992042
-4.66600000000000036948
-4.40650000000000030553
-4.59879999999999977689
-4.60440000000000004832
-4.32380000000000030980
-4.38429999999999964189
-4.60250000000000003553
-4.66999999999999992895
-4.56489999999999973568
-4.50879999999999991900
-4.42720000000000002416
-4.51679999999999992610
-4.43949999999999977973
-4.44789999999999974278
-4.54929999999999967741
-4.44679999999999964189
-4.29680000000000017479
-4.75820000000000042917
-4.41809999999999991616
-4.63849999999999962341
-4.44019999999999992468
-4.37300000000000022027
-4.71300000000000007816
-4.63889999999999957936
-4.58399999999999963052
-4.41220000000000034390
-4.55769999999999964047
-4.65920000000000023022
-4.58640000000000025437
-4.68449999999999988631
-4.51909999999999989484
-4.41750000000000042633
-4.43759999999999976694
-4.63689999999999979963
-4.42759999999999998010
-4.44639999999999968594
-4.42609999999999992326
];
PE3 = [2.12464999999999992752
1.95195000000000007390
1.96900000000000008349
2.01849999999999996092
2.15709999999999979536
1.96680000000000010374
2.11034999999999994813
1.97890000000000010338
1.94589999999999996305
2.12024999999999996803
2.05149999999999987921
1.93104999999999993321
2.12135000000000006892
2.08944999999999980744
2.12519999999999997797
2.10429999999999983729
1.94094999999999995310
2.01960000000000006182
1.99760000000000004228
2.00364999999999993108
2.05480000000000018190
2.11474999999999990763
1.84580000000000010729
1.94314999999999993285
1.85955000000000003624
2.08340000000000014069
2.07679999999999997939
2.10265000000000013003
1.92829999999999990301
1.91619999999999990337
2.08395000000000019114
2.03279999999999994031
1.87054999999999993499
2.05589999999999983871
2.06139999999999989910
2.05699999999999993960
2.07954999999999978755
2.14444999999999996732
1.83535000000000003695
2.05370000000000008100
2.01575000000000015277
2.01465000000000005187
2.08340000000000014069
2.08504999999999984794
2.06579999999999985860
2.04435000000000011156
2.05754999999999999005
1.99869999999999992113
2.18955000000000010729
1.97999999999999998224
2.03719999999999989981
1.97890000000000010338
2.13454999999999994742
1.90520000000000000462
2.08285000000000009024
2.01794999999999991047
2.20990000000000019753
2.20000000000000017764
2.06084999999999984865
1.96570000000000000284
1.90024999999999999467
2.02839999999999998082
2.19724999999999992539
2.00035000000000007248
2.00749999999999984013
1.96239999999999992220
2.00364999999999993108
1.89694999999999991402
2.00914999999999999147
2.02950000000000008171
2.14005000000000000782
1.99704999999999999183
1.95579999999999998295
2.03995000000000015206
2.00309999999999988063
1.96625000000000005329
1.91894999999999993356
1.99869999999999992113
1.83424999999999993605
1.94809999999999994280
1.96570000000000000284
2.05259999999999998010
1.99429999999999996163
1.89585000000000003517
1.83095000000000007745
2.07790000000000008029
2.19174999999999986500
1.98879999999999990123
1.92664999999999997371
2.02234999999999986997
2.07679999999999997939
1.80620000000000002771
2.08559999999999989839
1.98330000000000006288
1.92995000000000005436
1.91894999999999993356
2.05149999999999987921
2.02179999999999981952
1.98439999999999994174
1.92609999999999992326
];
KE3avg = mean(KE3);
PE3avg = mean(PE3);
sum3 = KE3avg + PE3avg

%U = 7.75
KE4  = [-3.88529999999999997584
-3.57520000000000015561
-4.02709999999999990195
-3.66310000000000002274
-3.37659999999999982379
-3.82670000000000021245
-3.45909999999999984155
-3.77470000000000016627
-3.62510000000000021103
-3.62380000000000013216
-3.85700000000000020606
-3.67859999999999986997
-3.73390000000000021885
-3.33199999999999985079
-3.97710000000000007958
-3.64550000000000018474
-3.47960000000000002629
-3.72080000000000010729
-3.71390000000000020108
-3.59949999999999992184
-3.75939999999999985292
-3.69079999999999985860
-3.72370000000000000995
-3.61819999999999986073
-3.66829999999999989413
-3.66539999999999999147
-3.64670000000000005258
-3.54050000000000020250
-3.77510000000000012221
-3.77139999999999986358
-3.84140000000000014779
-3.50010000000000021103
-3.57989999999999986002
-3.57319999999999993179
-3.80730000000000012861
-3.58680000000000021032
-3.57520000000000015561
-3.81219999999999981100
-3.68069999999999986073
-3.75260000000000015774
-3.41979999999999995097
-3.57589999999999985647
-3.64109999999999978115
-3.50289999999999990266
-3.73090000000000010516
-3.56660000000000021458
-3.65870000000000006324
-3.97199999999999997513
-3.75170000000000003482
-3.44130000000000002558
-3.51339999999999985647
-3.71589999999999998082
-3.83890000000000020108
-3.46640000000000014779
-3.88129999999999997229
-3.88640000000000007674
-3.63039999999999984936
-3.80500000000000015987
-3.68550000000000022027
-3.77229999999999998650
-3.85369999999999990337
-3.55989999999999984226
-3.93730000000000002203
-3.49080000000000012506
-3.88949999999999995737
-3.58049999999999979394
-3.69669999999999987494
-3.47949999999999981526
-3.72169999999999978613
-3.56769999999999987139
-3.74969999999999981100
-3.57220000000000004192
-3.71030000000000015348
-3.76140000000000007674
-3.48260000000000013998
-3.63620000000000009877
-3.51799999999999979394
-3.71019999999999994245
-3.75389999999999979252
-3.67419999999999991047
-3.73729999999999984439
-3.67930000000000001492
-3.51860000000000017195
-3.69289999999999984936
-3.50150000000000005684
-3.55699999999999993960
-3.84169999999999989271
-3.77769999999999983586
-4.19080000000000030269
-3.60179999999999989058
-3.90569999999999994955
-3.63070000000000003837
-3.93000000000000015987
-3.63070000000000003837
-3.64869999999999983231
-3.54749999999999987566
-3.79910000000000014353
-3.56809999999999982734
-3.72730000000000005755
-3.64570000000000016271
];
PE4 = [1.90959999999999996412
1.73987500000000006040
2.08397500000000013287
1.76544999999999996376
1.65617499999999995275
1.83442499999999997229
1.65694999999999992291
1.90339999999999998082
1.69802499999999989555
1.68795000000000006146
1.74607500000000004370
1.80109999999999992326
1.87549999999999994493
1.67942499999999994564
1.88325000000000009059
1.57634999999999991793
1.70655000000000001137
1.72514999999999996128
1.93284999999999995701
1.67787500000000000533
1.84450000000000002842
1.80652499999999993641
1.77397500000000007958
1.80187499999999989342
1.88169999999999992824
1.90572499999999989129
1.72127500000000011049
1.73599999999999998757
1.87240000000000006430
1.87395000000000000462
1.93439999999999989733
1.72360000000000002096
1.80187499999999989342
1.76777500000000009628
1.87627499999999991509
1.75770000000000004015
1.75072500000000008669
1.90185000000000004050
1.78560000000000007603
1.84759999999999990905
1.58719999999999994422
1.74065000000000003055
1.94369999999999998330
1.70732499999999998153
1.87240000000000006430
1.86000000000000009770
1.70267499999999993854
1.88867500000000010374
1.67090000000000005187
1.68252500000000004832
1.71274999999999999467
1.85457500000000008455
1.90727500000000005365
1.68562499999999992895
1.69802499999999989555
1.85302499999999992220
1.89487500000000008704
1.80574999999999996625
1.92044999999999999041
1.87162500000000009415
1.87084999999999990195
1.73057499999999997442
1.90727500000000005365
1.74219999999999997087
1.73677499999999995772
1.73832499999999989804
1.86542500000000011084
1.64919999999999999929
1.92355000000000009308
1.70112499999999999822
1.74994999999999989448
1.83519999999999994245
1.80885000000000006892
1.77397500000000007958
1.69260000000000010445
1.75537499999999990763
1.84604999999999996874
1.86775000000000002132
1.89332499999999992468
1.73677499999999995772
1.79180000000000005933
1.81117499999999997939
1.75459999999999993747
1.78637500000000004619
1.68484999999999995879
1.78715000000000001634
1.94757500000000005613
1.85379999999999989235
2.02507500000000018048
1.67632500000000006501
1.80109999999999992326
1.73832499999999989804
1.89719999999999999751
1.72205000000000008065
1.84217499999999989591
1.73367500000000007709
1.98710000000000008846
1.72980000000000000426
1.88712499999999994138
1.74452500000000010338
];
KE4avg = mean(KE4);
PE4avg = mean(PE4);
sum4 = KE4avg + PE4avg

%U = 10
KE5  = [-2.83650000000000002132
-2.93069999999999986073
-2.92620000000000013429
-3.05759999999999987352
-2.99710000000000009734
-3.07759999999999989129
-2.73289999999999988489
-2.96640000000000014779
-3.04519999999999990692
-2.96119999999999983231
-2.91020000000000012008
-2.86969999999999991758
-2.85829999999999984084
-3.02660000000000017906
-3.06380000000000007887
-2.96119999999999983231
-2.88589999999999990976
-2.91800000000000014921
-3.05500000000000015987
-3.02340000000000008740
-2.94700000000000006395
-2.98189999999999999503
-2.74390000000000000568
-2.97370000000000000995
-2.88350000000000017408
-3.14769999999999994245
-2.87210000000000009734
-2.94569999999999998508
-2.95520000000000004903
-3.09299999999999997158
-2.99840000000000017621
-3.15560000000000018261
-2.95339999999999980318
-3.04170000000000007034
-3.08219999999999982876
-2.99210000000000020393
-3.13799999999999990052
-2.92879999999999984794
-2.82770000000000010232
-2.86710000000000020393
-3.11419999999999985718
-2.89250000000000007105
-2.91959999999999997300
-2.95920000000000005258
-3.00110000000000010090
-2.99779999999999979821
-3.06230000000000002203
-2.84189999999999987068
-2.99060000000000014708
-2.87720000000000020179
-3.19390000000000018332
-2.83950000000000013500
-3.01889999999999991687
-3.06029999999999979821
-3.15960000000000018616
-3.00090000000000012292
-3.02159999999999984155
-2.92010000000000013998
-2.89579999999999992966
-2.95809999999999995168
-2.87300000000000022027
-3.11180000000000012150
-2.93579999999999996518
-2.75870000000000015206
-2.96720000000000005969
-2.80869999999999997442
-2.86439999999999983515
-2.93210000000000015064
-3.03100000000000013856
-3.00850000000000017408
-3.08309999999999995168
-3.17059999999999986287
-2.85720000000000018403
-2.85959999999999991971
-2.89000000000000012434
-3.05129999999999990123
-2.82900000000000018119
-2.86640000000000005898
-3.03460000000000018616
-2.88050000000000006040
-2.98289999999999988489
-3.13730000000000019966
-2.88560000000000016485
-3.08570000000000010942
-2.98010000000000019327
-2.97719999999999984652
-3.22750000000000003553
-3.03620000000000000995
-3.04630000000000000782
-2.96329999999999982307
-3.09229999999999982663
-3.10829999999999984084
-2.98749999999999982236
-3.01540000000000008029
-2.88580000000000014282
-2.91109999999999979892
-2.80989999999999984226
-3.11680000000000001492
-2.97380000000000022098
-2.96980000000000021743
];
PE5 = [1.32899999999999995914
1.51699999999999990408
1.58299999999999996270
1.54600000000000004086
1.40599999999999991651
1.52800000000000002487
1.40399999999999991473
1.51000000000000000888
1.62500000000000000000
1.56499999999999994671
1.50600000000000000533
1.43999999999999994671
1.41300000000000003375
1.48300000000000009592
1.54499999999999992895
1.59099999999999996980
1.45300000000000006928
1.45300000000000006928
1.44700000000000006395
1.50200000000000000178
1.50200000000000000178
1.45399999999999995914
1.42100000000000004086
1.54800000000000004263
1.54000000000000003553
1.49799999999999999822
1.36600000000000010303
1.42300000000000004263
1.46799999999999997158
1.64199999999999990408
1.59400000000000008349
1.76800000000000001599
1.52000000000000001776
1.53800000000000003375
1.54600000000000004086
1.38599999999999989875
1.59299999999999997158
1.33699999999999996625
1.48999999999999999112
1.40300000000000002487
1.64500000000000001776
1.46199999999999996625
1.53899999999999992362
1.64199999999999990408
1.64500000000000001776
1.49700000000000010836
1.56899999999999995026
1.39999999999999991118
1.59099999999999996980
1.52299999999999990941
1.63300000000000000711
1.37299999999999999822
1.55200000000000004619
1.58000000000000007105
1.73999999999999999112
1.42799999999999993605
1.56099999999999994316
1.46900000000000008349
1.54000000000000003553
1.52400000000000002132
1.37400000000000011013
1.49500000000000010658
1.60600000000000009415
1.52699999999999991296
1.63999999999999990230
1.47199999999999997513
1.46399999999999996803
1.49199999999999999289
1.51600000000000001421
1.57699999999999995737
1.61099999999999998757
1.66700000000000003730
1.43999999999999994671
1.49700000000000010836
1.35099999999999997868
1.59600000000000008527
1.46900000000000008349
1.46799999999999997158
1.55400000000000004796
1.45599999999999996092
1.38100000000000000533
1.54699999999999993072
1.50600000000000000533
1.63599999999999989875
1.57800000000000006928
1.58699999999999996625
1.61600000000000010303
1.63500000000000000888
1.48900000000000010125
1.56200000000000005507
1.74199999999999999289
1.55200000000000004619
1.54899999999999993250
1.57499999999999995559
1.58200000000000007283
1.52600000000000002309
1.39900000000000002132
1.60200000000000009059
1.63700000000000001066
1.41399999999999992362
];
KE5avg = mean(KE5);
PE5avg = mean(PE5);
sum5 = KE5avg + PE5avg

sum_values = [sum1, sum2, sum3, sum4, sum5]; % replace with actual sum values

%Find standard deiation which will be used as error bars
KE1std = std(KE1);
KE2std = std(KE2);
KE3std = std(KE3);
KE4std = std(KE4);
KE5std = std(KE5);

PE1std = std(PE1);
PE2std = std(PE2);
PE3std = std(PE3);
PE4std = std(PE4);
PE5std = std(PE5);

totalstd1 = sqrt(KE1std^2 + PE1std^2);
totalstd2 = sqrt(KE2std^2 + PE2std^2);
totalstd3 = sqrt(KE3std^2 + PE3std^2);
totalstd4 = sqrt(KE4std^2 + PE4std^2);
totalstd5 = sqrt(KE5std^2 + PE5std^2);
totalstd = [totalstd1, totalstd2, totalstd3, totalstd4, totalstd5];

%% Plotting the results
figure;
errorbar(U_values, sum_values, totalstd, 'x-', 'DisplayName', 'QMC Values','LineWidth', 1);
hold on;
plot(U_values, Theoretical_values, 'o', 'DisplayName', 'Theoretical Values','LineWidth', 2);
hold on;
xlabel('U/J');
ylabel('Energy');
title('Comparison of Theoretical and QMC Values for L=N=3, beta = 5');
legend('Location', 'southeast');