% Checking correlation between sigma^2 and l
% L=N=8, l=4
%assuming code sigma is sigma ^2***********************
%% --------------------------------- nmax = 8 -----------------------------------------
%julia Uppigsfli.jl -D 1 -L 8 -N 8 --nmax 8 -l 4 -U 1 --Up 1000 --mu .0001 --sweeps 100000 --seed 1 --measurement-frequency 25 --bin-size 10000 --bins-wanted 100 --num-replicas 1 --beta 5.0 --canonical true --get-n --get-corr
clc; clear all; close all;
figure;
sigma1_8 = [0.63057500000000010765
0.63147500000000000853
0.61407499999999992646
0.63925000000000009592
0.62282499999999996199
0.62755000000000005222
0.64389999999999991687
0.60850000000000004086
0.64575000000000004619
0.62945000000000006501
0.64674999999999993605
0.62985000000000002096
0.59410000000000007248
0.64402500000000006963
0.61779999999999990479
0.61169999999999991047
0.60919999999999996376
0.59759999999999990905
0.60902499999999992752
0.61977499999999996483
0.63119999999999998330
0.61210000000000008846
0.63955000000000006288
0.61202500000000004121
0.62169999999999991935
0.65199999999999991296
0.61692499999999994564
0.61254999999999992788
0.62315000000000009273
0.62250000000000005329
0.63842500000000002025
0.63949999999999995737
0.61695000000000010942
0.60267500000000007176
0.63527500000000003411
0.61789999999999989377
0.62282499999999996199
0.61412500000000003197
0.61787499999999995204
0.62342499999999989591
0.60969999999999990870
0.58747499999999996945
0.61387499999999994849
0.61432500000000000995
0.63582500000000008455
0.64115000000000010871
0.60132500000000010942
0.61610000000000009202
0.60682499999999994778
0.62542499999999989768
0.61232500000000000817
0.61945000000000005613
0.62697500000000006004
0.64684999999999992504
0.62307500000000004547
0.60244999999999993001
0.64022500000000004405
0.62490000000000001101
0.61214999999999997193
0.60525000000000006573
0.63167499999999998650
0.62719999999999997975
0.61240000000000005542
0.62335000000000007070
0.62707500000000004903
0.62799999999999989164
0.61352500000000009805
0.62929999999999997051
0.63884999999999991793
0.60620000000000007212
0.60547499999999998543
0.63280000000000002913
0.62985000000000002096
0.63549999999999995381
0.61955000000000004512
0.63247499999999989839
0.62002500000000004832
0.60955000000000003624
0.61697500000000005116
0.60227499999999989377
0.62117500000000003268
0.62979999999999991545
0.61357499999999998153
0.62257500000000010054
0.61412500000000003197
0.62290000000000000924
0.61779999999999990479
0.64587499999999997691
0.61860000000000003872
0.62947500000000000675
0.61484999999999989662
0.60610000000000008313
0.63452500000000000568
0.61262499999999997513
0.63467500000000010019
0.61807499999999993001
0.61620000000000008100
0.60682499999999994778
0.61365000000000002878
0.61789999999999989377
];

sigma2_8 = [0.91425000000000000711
0.94915000000000038227
0.90845000000000020179
0.93855000000000021743
0.89217499999999994031
0.91377500000000022595
0.95559999999999956088
0.91420000000000012363
0.94749999999999978684
0.93620000000000036522
0.96720000000000005969
0.94857499999999994600
0.89125000000000031974
0.94872499999999959641
0.86580000000000012506
0.88652499999999978542
0.88422499999999981668
0.84582499999999960494
0.89095000000000013074
0.91367499999999957083
0.91927499999999984226
0.90012500000000006395
0.96820000000000039364
0.87760000000000015774
0.92737499999999961631
0.96579999999999976978
0.91779999999999972715
0.91319999999999978968
0.91429999999999989058
0.90620000000000011653
0.94207499999999999574
0.95397499999999979536
0.88907500000000005969
0.88412500000000004974
0.94802500000000033964
0.91345000000000009521
0.87199999999999988631
0.90805000000000024585
0.88295000000000012363
0.91284999999999971720
0.87619999999999986784
0.86572500000000029985
0.90390000000000014779
0.88017500000000037375
0.96229999999999993321
0.95017499999999976978
0.85379999999999967031
0.92402500000000031832
0.88079999999999980531
0.89002499999999962199
0.90029999999999965610
0.89147499999999979536
0.95137499999999963762
0.95540000000000002700
0.89885000000000037090
0.89665000000000016911
0.94125000000000014211
0.90570000000000039364
0.89947499999999980247
0.90265000000000039648
0.89827499999999993463
0.93025000000000002132
0.88997499999999973852
0.90775000000000005684
0.92722499999999996589
0.91732499999999994600
0.91525000000000034106
0.92609999999999992326
0.93750000000000000000
0.84662500000000040501
0.88907500000000005969
0.93705000000000016058
0.92822500000000029985
0.92234999999999978115
0.93427500000000041069
0.97107499999999991047
0.93165000000000031122
0.88862500000000022027
0.91987500000000022027
0.85189999999999965752
0.91835000000000022169
0.93702500000000021885
0.90455000000000040927
0.91607500000000019469
0.88279999999999958504
0.91052499999999980673
0.88427499999999970015
0.95249999999999968026
0.91022499999999961773
0.90332499999999971152
0.89674999999999993605
0.87445000000000039364
0.92785000000000028564
0.89719999999999977547
0.95957500000000006679
0.91394999999999981810
0.89727499999999960067
0.88239999999999962910
0.90227500000000038227
0.89972500000000010800
];

sigma3_8 = [1.06010000000000026432
1.07542499999999918714
1.09107500000000001705
1.02285000000000003695
1.03197499999999919851
1.08282499999999970441
1.04062500000000035527
1.09440000000000026148
1.07982499999999959073
1.11247499999999988063
1.10962499999999941735
1.02319999999999922125
1.09559999999999924114
0.96827500000000021885
1.03004999999999924398
1.01767500000000055138
0.98590000000000088676
1.02635000000000076170
1.02962499999999934630
1.05897500000000022169
1.03359999999999985221
1.13909999999999911324
0.98322499999999912745
1.08324999999999960210
1.10740000000000016200
1.06922499999999942588
1.05550000000000032685
1.06540000000000034674
1.05059999999999931219
1.08582499999999981810
1.09185000000000087539
1.01762500000000066791
1.02282499999999920703
1.09772500000000050591
1.04354999999999975557
0.97442500000000009663
1.05300000000000082423
0.99352499999999999147
1.07147499999999951115
1.00120000000000075602
1.00957499999999988916
1.05012499999999953104
0.99982499999999951967
1.12902500000000038938
1.08132499999999964757
0.94407499999999977547
1.07515000000000071623
1.01014999999999943725
1.00752499999999933777
1.03332499999999960494
1.01837500000000069633
1.09367499999999928662
1.08455000000000012506
1.05414999999999992042
1.02544999999999930651
1.08042499999999996874
1.01427499999999959357
1.03197499999999919851
1.04727500000000084412
1.01554999999999928662
1.08629999999999959925
1.01885000000000047748
1.03607500000000030127
1.06799999999999961631
1.03834999999999944009
1.03429999999999999716
1.07537499999999930367
1.08425000000000082423
0.94387500000000024158
1.00714999999999932356
1.08114999999999916724
1.07002499999999933777
1.00402500000000038938
1.08605000000000018190
1.14537499999999958789
1.06569999999999964757
1.01507499999999950546
1.07070000000000042917
0.94684999999999952536
1.05272500000000057696
1.09120000000000061391
1.04035000000000010800
1.03090000000000081570
0.99735000000000084697
1.06677499999999980673
1.01212499999999927525
1.09647499999999986642
1.05790000000000006253
1.02275000000000027001
1.03377500000000033253
1.00455000000000005400
1.09125000000000049738
1.03267499999999934346
1.10590000000000010516
1.07322500000000076170
1.02782499999999998863
1.00802499999999994884
1.03977500000000055991
1.07417500000000032401
];

sigma4_8 = [1.11205000000000000000
1.16365000000000000000
1.13815000000000000000
1.14592500000000000000
1.05315000000000000000
1.06407500000000000000
1.11120000000000000000
1.08755000000000000000
1.15050000000000000000
1.12670000000000000000
1.15595000000000000000
1.16827500000000000000
1.06680000000000000000
1.14405000000000000000
0.97060000000000000000
1.07512500000000000000
1.05640000000000000000
1.02725000000000000000
1.06897500000000000000
1.05087500000000000000
1.12070000000000000000
1.07237500000000000000
1.19072500000000000000
1.01707500000000000000
1.13445000000000000000
1.14417500000000000000
1.12107500000000000000
1.10675000000000000000
1.09434999999999999999
1.10797499999999999999
1.12835000000000000000
1.13047500000000000000
1.05105000000000000000
1.05720000000000000000
1.13610000000000000000
1.07620000000000000000
0.98980000000000000000
1.09517500000000000000
1.01967500000000000000
1.12992500000000000000
1.04080000000000000000
1.05645000000000000000
1.08362500000000000000
1.03862500000000000000
1.17122500000000000000
1.12307500000000000000
0.94527500000000000000
1.12620000000000000000
1.05079999999999999999
1.04384999999999999999
1.08814999999999999999
1.06692500000000000000
1.13817500000000000000
1.12267500000000000000
1.09570000000000000000
1.07840000000000000000
1.11535000000000000000
1.06467500000000000000
1.06804999999999999999
1.09227500000000000000
1.04745000000000000000
1.13612499999999999999
1.05734999999999999999
1.08277500000000000000
1.10210000000000000000
1.06175000000000000000
1.06140000000000000000
1.10620000000000000000
1.09737499999999999999
0.96372500000000000000
1.04627500000000000000
1.10480000000000000000
1.11545000000000000000
1.01450000000000000000
1.13840000000000000000
1.21212500000000000000
1.09097500000000000000
1.06535000000000000000
1.12467500000000000000
0.96542500000000000000
1.08495000000000000000
1.14937500000000000000
1.07662500000000000000
1.06447500000000000000
1.02790000000000000000
1.12040000000000000000
1.06072500000000000000
1.12690000000000000000
1.10225000000000000000
1.05660000000000000000
1.07212500000000000000
1.03765000000000000000
1.15082500000000000000
1.07082500000000000000
1.14297500000000000000
1.13215000000000000000
1.07745000000000000000
1.04890000000000000000
1.08075000000000000000
1.12400000000000000000
];

sigma1avg_8 = mean(sigma1_8);
sigma2avg_8 = mean(sigma2_8);
sigma3avg_8 = mean(sigma3_8);
sigma4avg_8 = mean(sigma4_8);
subplot(2, 4, 1);
plot([log(8/(pi*sin((pi*1)/8))), log(8/(pi*sin((pi*2)/8))),log(8/(pi*sin((pi*3)/8))),log(8/(pi*sin((pi*4)/8)))],[sigma1avg_8, sigma2avg_8, sigma3avg_8, sigma4avg_8],'bo')
xlabel("ln(L/πsin(πℓ/L))");
ylabel("Sigma^2")
title("L=N=8,nmax = 8")

%% --------------------------------- nmax = 7 -----------------------------------------
sigma1_7 = [0.6305750000000001
0.6314750000000000
0.6297750000000000
0.5964750000000001
0.6203250000000000
0.6117250000000001
0.6077000000000000
0.6244250000000000
0.6369000000000000
0.6223750000000000
0.6096750000000000
0.6272500000000001
0.5949999999999999
0.6173250000000000
0.6111750000000000
0.6065250000000000
0.6149999999999999
0.6109000000000000
0.6300750000000000
0.5905000000000000
0.6367250000000000
0.5991500000000001
0.5944000000000000
0.6099500000000000
0.6034750000000000
0.6270750000000000
0.6081000000000001
0.6296500000000000
0.6140500000000000
0.6211500000000001
0.6490750000000001
0.6107000000000000
0.6046250000000000
0.6340250000000001
0.6327000000000000
0.6254500000000001
0.6042750000000000
0.6050500000000001
0.6231750000000000
0.6343250000000000
0.6363250000000000
0.6201500000000000
0.6449250000000000
0.6187750000000001
0.6181000000000001
0.6403500000000000
0.6514000000000000
0.6209750000000001
0.6353750000000000
0.6515250000000000
0.6219500000000000
0.6254750000000000
0.6328250000000000
0.6284750000000000
0.6122500000000000
0.6333750000000000
0.6204250000000000
0.6316000000000000
0.6495000000000000
0.6226500000000000
0.6117250000000001
0.6307000000000000
0.6144750000000001
0.6377000000000000
0.6268500000000000
0.6316750000000000
0.6422250000000000
0.6372750000000000
0.6122250000000000
0.6284000000000000
0.6188750000000000
0.6127750000000000
0.6596250000000000
0.6373000000000000
0.6010000000000000
0.5993250000000000
0.6352250000000000
0.5992000000000000
0.6191250000000000
0.6274000000000000
0.6147250000000000
0.6189250000000000
0.6152500000000000
0.6215250000000001
0.6349750000000001
0.6210750000000000
0.6249500000000000
0.6293000000000000
0.6352750000000000
0.6523250000000000
0.6183000000000000
0.6187750000000001
0.6468750000000001
0.6134250000000000
0.6210750000000000
0.6284750000000000
0.6353250000000000
0.6316500000000000
0.6168250000000000
0.5871750000000000
];

sigma2_7 = [0.91425000000000000711
0.94915000000000038227
0.92707500000000031548
0.86880000000000023874
0.91627499999999972857
0.89982499999999987494
0.87442499999999956373
0.90404999999999979821
0.92135000000000033538
0.91774999999999984368
0.90197500000000019327
0.92354999999999964899
0.84684999999999988063
0.91959999999999997300
0.88755000000000006111
0.88432499999999958362
0.88637500000000013500
0.88529999999999997584
0.94407499999999977547
0.84164999999999956515
0.95014999999999982805
0.85805000000000042348
0.87962499999999987921
0.89515000000000011227
0.85902499999999992752
0.92707500000000031548
0.89107499999999983942
0.92687499999999989342
0.91404999999999958504
0.91612500000000007816
0.93839999999999967883
0.86184999999999956088
0.86317500000000002558
0.94162500000000015632
0.90907499999999963336
0.93347499999999961062
0.88422499999999981668
0.85327500000000000568
0.92954999999999987637
0.93462499999999959499
0.94697500000000012221
0.91942500000000038085
0.94292499999999979110
0.87412500000000026290
0.90822499999999983800
0.94867499999999971294
0.94502500000000022595
0.92074999999999995737
0.93687499999999968026
0.94567499999999959925
0.93427500000000041069
0.88680000000000003268
0.94629999999999991900
0.91199999999999992184
0.88199999999999967315
0.92569999999999996732
0.89012500000000027711
0.91364999999999962910
0.93320000000000025153
0.92432499999999961915
0.86612500000000025580
0.92437500000000039080
0.92572499999999990905
0.96437500000000042633
0.91467499999999990479
0.91702499999999975699
0.93189999999999972857
0.96110000000000006537
0.91447500000000037090
0.93372499999999991616
0.92105000000000014637
0.86417500000000035953
0.95190000000000019043
0.91035000000000021458
0.87950000000000017053
0.88052499999999955804
0.95335000000000036380
0.87132499999999968310
0.91120000000000000995
0.94594999999999984652
0.91022499999999961773
0.93320000000000025153
0.88705000000000033822
0.89864999999999994884
0.93212500000000009237
0.93649999999999966604
0.87840000000000006963
0.91517499999999962768
0.94460000000000032827
0.99117500000000013927
0.89384999999999958931
0.91715000000000035385
0.96577499999999982805
0.93454999999999976978
0.90010000000000012221
0.91270000000000006679
0.92649999999999987921
0.93510000000000026432
0.92072500000000001563
0.86179999999999967741
];

sigma3_7 = [1.06010000000000026432
1.12252499999999955094
1.07837499999999941735
0.99617499999999914451
1.08377499999999926672
1.05022499999999929798
0.99217499999999958504
1.01745000000000018758
1.04325000000000045475
1.04087499999999977263
1.01922500000000049170
1.07057499999999983231
0.97240000000000037517
1.07339999999999946567
0.99467500000000086402
1.00442499999999945715
1.01340000000000074465
1.00810000000000066223
1.10285000000000010800
0.95110000000000027853
1.09950000000000081002
0.98157499999999942020
1.03894999999999981810
1.01467500000000043769
0.98077499999999950830
1.08232500000000086970
1.01642499999999991189
1.05000000000000071054
1.04847499999999982379
1.05995000000000061391
1.03325000000000066791
0.97530000000000072191
0.98794999999999966178
1.05119999999999969020
1.03200000000000002842
1.08024999999999948841
1.04982500000000023022
0.97027500000000088676
1.05657500000000048601
1.07662499999999994316
1.09857500000000030127
1.05264999999999986358
1.06262500000000059686
0.97175000000000011369
1.06877500000000047464
1.08610000000000006537
1.07737499999999997158
1.05622499999999952536
1.07782500000000069917
1.05337500000000083844
1.06912499999999965894
1.00239999999999973568
1.10767500000000040927
1.05767499999999969873
1.00304999999999999716
1.07742499999999985505
1.00212499999999948841
1.04257499999999936335
1.05447500000000005116
1.06227499999999963620
0.99740000000000073044
1.06717500000000065086
1.06112500000000054001
1.15920000000000023022
1.04147500000000015064
1.02924999999999933209
1.05587500000000034106
1.12412499999999937472
1.03009999999999912745
1.05920000000000058549
1.07610000000000027853
0.99114999999999930935
1.06182500000000068496
1.03775000000000083844
1.00412500000000015632
1.03180000000000049454
1.09362499999999940314
1.00985000000000013642
1.01195000000000057128
1.12787499999999951683
1.04877499999999912461
1.10670000000000001705
1.02547500000000013642
1.02679999999999971294
1.09852500000000041780
1.13649999999999984368
1.01567499999999988347
1.05219999999999913598
1.10515000000000007674
1.15629999999999988347
1.01784999999999925535
1.03059999999999973852
1.13444999999999929230
1.12015000000000064517
1.03182499999999954809
1.03977500000000055991
1.07682499999999947704
1.05362500000000025580
1.08114999999999916724
0.98649999999999948841
];

sigma4_7 = [1.11204999999999998295
1.16365000000000051728
1.14157499999999956231
1.02179999999999893134
1.13789999999999835723
1.08239999999999980673
1.01214999999999832880
1.05542499999999961346
1.06657500000000027285
1.05989999999999895408
1.04025000000000034106
1.11467499999999830607
0.99324999999999974420
1.11802499999999938041
1.01389999999999957936
1.05189999999999983515
1.04135000000000133014
1.04189999999999827196
1.15615000000000023306
0.97710000000000007958
1.12757500000000021600
0.98742500000000177351
1.08849999999999980105
1.05692499999999967031
1.01167500000000032401
1.10800000000000054001
1.04844999999999899387
1.07697500000000090381
1.08569999999999922125
1.11207500000000081286
1.04905000000000114824
0.99217499999999958504
1.02677500000000065938
1.08342499999999830607
1.06534999999999868692
1.13510000000000133014
1.10337499999999977263
1.01102500000000006253
1.10257500000000163709
1.11155000000000114824
1.14322500000000104592
1.07857500000000072760
1.10320000000000106866
0.99950000000000116529
1.12692499999999995453
1.12557500000000132445
1.13712500000000105160
1.11114999999999852776
1.10417500000000146088
1.07897499999999979536
1.10822500000000090381
1.03280000000000171667
1.15052499999999824354
1.09925000000000139266
1.02562500000000156319
1.13159999999999882903
1.02907499999999885176
1.08377499999999926672
1.08932499999999876650
1.10579999999999856186
1.04542500000000160298
1.10297500000000070486
1.08125000000000071054
1.21157499999999984652
1.08575000000000088107
1.05922500000000141540
1.09277499999999960778
1.16444999999999865281
1.04735000000000155751
1.08947500000000019327
1.12282499999999885176
1.02317499999999839133
1.08747500000000130171
1.06514999999999915303
1.04390000000000071623
1.08650000000000090949
1.13312499999999971578
1.04854999999999876081
1.04982499999999845386
1.18564999999999898250
1.09042499999999975557
1.16422499999999828901
1.06717499999999887450
1.06427499999999852776
1.16475000000000150635
1.21450000000000102318
1.07019999999999981810
1.10689999999999955094
1.15367499999999978400
1.20997500000000002274
1.04272500000000079012
1.05287500000000022737
1.19804999999999850502
1.16829999999999856186
1.06737499999999840838
1.09207500000000123919
1.09305000000000163141
1.08459999999999823217
1.13047500000000056275
1.02025000000000076739
];

sigma1avg_7 = mean(sigma1_7);
sigma2avg_7 = mean(sigma2_7);
sigma3avg_7 = mean(sigma3_7);
sigma4avg_7 = mean(sigma4_7);
subplot(2, 4, 2);
plot([log(8/(pi*sin((pi*1)/8))), log(8/(pi*sin((pi*2)/8))),log(8/(pi*sin((pi*3)/8))),log(8/(pi*sin((pi*4)/8)))],[sigma1avg_7, sigma2avg_7, sigma3avg_7, sigma4avg_7],'bo')
xlabel("ln(L/πsin(πℓ/L))");
ylabel("Sigma^2")
title("L=N=8,nmax = 7")


%% --------------------------------- nmax = 6 -----------------------------------------
sigma1_6 = [0.624625
0.624550
0.613875
0.604025
0.642775
0.638800
0.631525
0.638100
0.621575
0.616975
0.614525
0.627850
0.615375
0.621750
0.628625
0.617600
0.626225
0.613100
0.623375
0.644600
0.642125
0.649775
0.609450
0.619575
0.620425
0.629900
0.627050
0.624150
0.620650
0.637975
0.617525
0.614875
0.619550
0.636725
0.628175
0.600875
0.633975
0.621900
0.644725
0.623750
0.610999
0.630050
0.629125
0.598450
0.640950
0.603575
0.613475
0.619975
0.639825
0.615750
0.624700
0.624775
0.631175
0.653450
0.612400
0.606575
0.636775
0.637150
0.611750
0.618900
0.613925
0.633950
0.614950
0.625175
0.625900
0.610050
0.614500
0.598800
0.618175
0.629875
0.621025
0.626900
0.594450
0.623275
0.624075
0.620550
0.641400
0.618025
0.614100
0.606250
0.620925
0.609125
0.622200
0.634975
0.607275
0.638200
0.636250
0.619125
0.623775
0.594550
0.645725
0.609925
0.633725
0.635375
0.611500
0.638825
0.629925
0.628625
0.632600
0.617475
];

sigma2_6 = [0.93862500000000004263
0.91800000000000014921
0.92052499999999959357
0.88312499999999971578
0.99207499999999981810
0.95637500000000041922
0.94610000000000038511
0.93414999999999981384
0.89497499999999963194
0.89625000000000021316
0.90022499999999983089
0.91752500000000036806
0.87582499999999985363
0.90582500000000010232
0.93280000000000029559
0.91697499999999987352
0.92994999999999983231
0.89577500000000043201
0.91967499999999979821
0.99760000000000026432
0.95485000000000042064
0.96455000000000001847
0.87707499999999960494
0.90337499999999959499
0.92849999999999965894
0.93972500000000014353
0.94562499999999971578
0.91849999999999987210
0.93559999999999998721
0.97365000000000012648
0.90307500000000029416
0.92070000000000007390
0.89200000000000034817
0.96720000000000005969
0.93435000000000023590
0.84297500000000002984
0.98399999999999998579
0.90137499999999981526
0.96509999999999962483
0.89890000000000025437
0.88285000000000035669
0.87217500000000036664
0.91117500000000006821
0.87387499999999995737
0.97649999999999970157
0.86955000000000026716
0.90002500000000029701
0.90730000000000021743
0.94864999999999977121
0.89322500000000015774
0.91787500000000044054
0.90434999999999998721
0.91110000000000024301
0.97762499999999974420
0.89302499999999973568
0.87872500000000020037
0.94800000000000039790
0.94130000000000002558
0.89309999999999956088
0.91389999999999993463
0.88987499999999997158
0.94130000000000002558
0.92502499999999976410
0.89007500000000039364
0.95045000000000001705
0.91222500000000028564
0.89820000000000010942
0.84677500000000005542
0.92527500000000006963
0.92242499999999960636
0.90064999999999972857
0.91990000000000016200
0.87977500000000041780
0.91800000000000014921
0.91209999999999968878
0.89422499999999960352
0.95722500000000021458
0.89642499999999980531
0.86014999999999997016
0.87767499999999998295
0.92260000000000008669
0.88837499999999991473
0.91704999999999969873
0.92994999999999983231
0.88432499999999958362
0.95800000000000018474
0.92252500000000026148
0.90899999999999980815
0.91612500000000007816
0.85112499999999968736
0.98125000000000017764
0.85240000000000026859
0.91777499999999978542
0.92175000000000029132
0.89184999999999980957
0.93627500000000019043
0.96067500000000016769
0.92767499999999980531
0.95262500000000027711
0.90200000000000013500
];

sigma3_6 = [1.090425
1.046150
1.067175
1.031900
1.171650
1.093200
1.090400
1.057075
1.018750
1.019350
1.045450
1.036150
0.998700
1.037975
1.056500
1.065675
1.073450
1.030275
1.061225
1.163975
1.108100
1.146600
0.999000
1.039550
1.082375
1.106750
1.102625
1.051750
1.084700
1.165450
1.026775
1.069675
0.995900
1.125976
1.046675
0.954325
1.169051
1.022475
1.108825
1.021500
1.002125
0.996850
1.051275
1.007150
1.157550
0.987150
1.019999
1.047375
1.093700
1.006450
1.077375
1.045625
1.046250
1.132475
1.016625
1.012951
1.089675
1.081225
0.993700
1.071825
1.010999
1.090550
1.064000
1.017075
1.117750
1.049025
0.983825
0.965850
1.076525
1.041399
1.043900
1.063050
0.991700
1.066800
1.051825
1.019100
1.105025
1.025675
0.950650
0.999225
1.069450
1.018225
1.069500
1.067850
1.026025
1.119925
1.028875
1.040950
1.060325
0.995300
1.160150
0.949925
1.047600
1.049525
1.020575
1.087125
1.134475
1.060800
1.120350
1.037575
];

sigma4_6 = [1.13792499999999918714
1.07617499999999921556
1.12359999999999971010
1.08279999999999887450
1.22412500000000079581
1.13217500000000015348
1.13467500000000143245
1.10060000000000002274
1.04234999999999899956
1.04257499999999936335
1.06412500000000065370
1.08125000000000071054
1.05095000000000027285
1.08824999999999860734
1.11222499999999868692
1.09625000000000127898
1.11925000000000096634
1.08194999999999907914
1.11349999999999837996
1.21760000000000090381
1.14845000000000041496
1.21177499999999938041
1.03522500000000050591
1.07437499999999985789
1.12652500000000088676
1.14832499999999981810
1.15312499999999928946
1.06992500000000134719
1.13820000000000121076
1.24147500000000121645
1.05267500000000069349
1.11489999999999866986
1.02659999999999840270
1.19699999999999917577
1.08559999999999945430
0.97377499999999983515
1.23402499999999903935
1.06040000000000134150
1.13510000000000133014
1.07495000000000118234
1.04110000000000013642
1.05679999999999907345
1.09339999999999903935
1.05334999999999823217
1.21620000000000061391
1.02477500000000176783
1.07182500000000047180
1.08142499999999941451
1.12480000000000046612
1.03875000000000028422
1.11407499999999970441
1.08634999999999948272
1.08747500000000130171
1.17670000000000030127
1.05205000000000126192
1.06987499999999968736
1.14495000000000146656
1.13019999999999853912
1.00015000000000142677
1.10572499999999962483
1.05892499999999856186
1.14247500000000101750
1.09622500000000044906
1.05067499999999824922
1.18114999999999881197
1.09742500000000120508
0.99119999999999919282
1.00247500000000044906
1.12987499999999840838
1.07167499999999904503
1.09002500000000068781
1.08575000000000088107
1.01849999999999951683
1.11145000000000138130
1.09672499999999928377
1.04727499999999906777
1.15462499999999934630
1.06449999999999889155
0.97510000000000118803
1.02534999999999953957
1.11647500000000121645
1.07897499999999979536
1.12797499999999928377
1.12697500000000161435
1.07365000000000065938
1.16625000000000156319
1.05444999999999922125
1.08117500000000177351
1.10135000000000005116
1.03922499999999828901
1.20677500000000037517
0.97247499999999931219
1.07469999999999998863
1.09120000000000061391
1.05217499999999830607
1.12927499999999980673
1.19650000000000034106
1.10249999999999914735
1.17139999999999844249
1.08427500000000165414
];

sigma1avg_6 = mean(sigma1_6);
sigma2avg_6 = mean(sigma2_6);
sigma3avg_6 = mean(sigma3_6);
sigma4avg_6 = mean(sigma4_6);
subplot(2, 4, 3);
plot([log(8/(pi*sin((pi*1)/8))), log(8/(pi*sin((pi*2)/8))),log(8/(pi*sin((pi*3)/8))),log(8/(pi*sin((pi*4)/8)))],[sigma1avg_6, sigma2avg_6, sigma3avg_6, sigma4avg_6],'bo')
xlabel("ln(L/πsin(πℓ/L))");
ylabel("Sigma^2")
title("L=N=8,nmax = 6")

%% --------------------------------- nmax = 5 -----------------------------------------
sigma1_5 = [0.61674999999999990941
0.62070000000000002949
0.62165000000000003588
0.63185000000000002274
0.62624999999999997335
0.61017499999999991189
0.61844999999999994422
0.63237499999999990941
0.62967499999999998472
0.61129999999999995453
0.62715000000000009628
0.64014999999999999680
0.62664999999999992930
0.61484999999999989662
0.63477500000000008917
0.64755000000000006999
0.61857500000000009699
0.61552500000000009983
0.65280000000000004690
0.63762500000000010836
0.63610000000000010978
0.60977499999999995595
0.61105000000000009308
0.60254999999999991900
0.62610000000000010090
0.62877500000000008384
0.60365000000000001990
0.62087500000000006573
0.63145000000000006679
0.60897500000000004405
0.61887500000000006395
0.63700000000000001066
0.63337500000000002132
0.62962500000000010125
0.65327500000000005009
0.63979999999999992433
0.63412500000000004974
0.63704999999999989413
0.62799999999999989164
0.64060000000000005826
0.65430000000000010374
0.61607499999999992824
0.62759999999999993570
0.63542499999999990656
0.66322499999999995346
0.62680000000000002380
0.60642499999999999183
0.65212500000000006573
0.62105000000000010196
0.60977499999999995595
0.61709999999999998188
0.63769999999999993356
0.61502499999999993285
0.61387499999999994849
0.62030000000000007354
0.64510000000000000675
0.62282499999999996199
0.64407499999999995310
0.63795000000000001705
0.60179999999999989058
0.62597499999999994813
0.62722499999999992149
0.62010000000000009557
0.61247500000000010267
0.61707500000000004015
0.63945000000000007390
0.62274999999999991473
0.63434999999999996945
0.63727500000000003588
0.60355000000000003091
0.61099999999999998757
0.63119999999999998330
0.61389999999999989022
0.60244999999999993001
0.61827499999999990798
0.64395000000000002238
0.60945000000000004725
0.60357499999999997264
0.60519999999999996021
0.61854999999999993321
0.59929999999999994387
0.61109999999999997655
0.62542499999999989768
0.61480000000000001315
0.61647500000000010623
0.60672499999999995879
0.62935000000000007603
0.61447500000000010445
0.65159999999999995701
0.59620000000000006324
0.62307500000000004547
0.62379999999999991012
0.63975000000000004086
0.60817499999999991012
0.62157499999999998863
0.60787499999999994316
0.62359999999999993214
0.64097500000000007248
0.61722499999999991260
0.62287500000000006750
];

sigma2_5 = [0.89442500000000002558
0.88989999999999991331
0.92534999999999989484
0.94197500000000022879
0.94647500000000039933
0.88327500000000025437
0.88595000000000023732
0.92227499999999995595
0.95362499999999972289
0.91632499999999961204
0.92269999999999985363
0.95307500000000011653
0.92379999999999995453
0.87247499999999966747
0.94939999999999979963
0.99377500000000029701
0.89595000000000002416
0.89109999999999978115
0.95287499999999969447
0.92959999999999975984
0.95404999999999962057
0.91329999999999955662
0.89085000000000036380
0.88377499999999997726
0.89804999999999957083
0.91324999999999967315
0.87752500000000033253
0.91562500000000035527
0.94662500000000004974
0.86655000000000015348
0.87577499999999997016
0.91535000000000010800
0.93782500000000013074
0.90214999999999978542
0.96739999999999959357
0.96649999999999991473
0.93117499999999964189
0.92684999999999995168
0.92687499999999989342
0.97037499999999976552
0.99929999999999985505
0.89542500000000035953
0.90890000000000004121
0.96122499999999977405
1.01252500000000011937
0.91782499999999966889
0.86532500000000034390
1.01775000000000037659
0.90950000000000041922
0.92482500000000023022
0.90580000000000016058
0.97044999999999959073
0.88435000000000041354
0.89644999999999974705
0.91702499999999975699
0.93539999999999956515
0.93702500000000021885
0.94969999999999998863
0.96680000000000010374
0.88382499999999986073
0.91750000000000042633
0.93657500000000037943
0.87332500000000035101
0.88584999999999958220
0.92392499999999966320
0.93122500000000041354
0.92302499999999998437
0.93465000000000042490
0.91757500000000025153
0.90969999999999995310
0.91117500000000006821
0.92047499999999971010
0.86237500000000011369
0.87889999999999979252
0.91399999999999970157
0.96265000000000000568
0.91019999999999967599
0.88044999999999973284
0.89712499999999995026
0.89592500000000008242
0.90225000000000044054
0.90482499999999976836
0.90612500000000029132
0.89710000000000000853
0.89387500000000041922
0.86289999999999977831
0.93590000000000017621
0.88462499999999977263
0.98117500000000035243
0.86882500000000018048
0.90947499999999958931
0.92677500000000012648
0.93759999999999976694
0.89887500000000031264
0.90222499999999961062
0.89590000000000014069
0.90352500000000013358
0.94712499999999977263
0.89777500000000021174
0.89745000000000008100
];

sigma3_5 = [1.03597500000000053433
1.03657499999999913598
1.04875000000000007105
1.08617500000000077875
1.11314999999999919567
1.00867500000000021032
0.99117500000000013927
1.08152499999999918145
1.09104999999999918714
1.04865000000000030411
1.04297500000000020748
1.08029999999999937188
1.06969999999999920703
0.96847499999999975273
1.07787500000000058265
1.15282499999999998863
1.01392500000000040927
1.03382500000000021600
1.08360000000000056275
1.06525000000000069633
1.12332499999999946283
1.07502500000000011937
1.01782500000000020179
1.01045000000000051443
1.01302500000000073044
1.05039999999999977831
0.97295000000000086970
1.03270000000000017337
1.08247500000000052012
0.97602499999999992042
1.00527499999999925251
1.07404999999999972715
1.10139999999999993463
1.00810000000000066223
1.10955000000000048033
1.13492500000000084981
1.05325000000000024158
1.06672499999999992326
1.08164999999999977831
1.09417499999999989768
1.16157499999999913598
1.03604999999999947136
1.04102499999999942304
1.09244999999999947704
1.17149999999999998579
1.08094999999999963336
0.98222499999999968168
1.21899999999999941735
1.01185000000000080433
1.08372499999999938325
1.06525000000000069633
1.13679999999999914451
1.00859999999999949694
1.02210000000000000853
1.05822500000000019327
1.08562500000000028422
1.08810000000000073328
1.09420000000000072760
1.13879999999999981242
1.00322500000000047748
1.07399999999999984368
1.06044999999999944862
0.98367499999999985505
0.97899999999999920419
1.08949999999999924682
1.06724999999999958789
1.06649999999999955946
1.07360000000000077591
1.02435000000000009379
1.05935000000000023590
1.05787499999999923261
1.04424999999999990052
0.96204999999999962768
0.96529999999999915872
1.07169999999999987494
1.09942500000000009663
1.04069999999999929230
1.00285000000000046327
1.04057500000000047180
1.02014999999999922409
1.05015000000000036096
1.04777499999999967883
1.05310000000000059117
0.99472500000000074749
1.01152500000000067359
0.96279999999999965610
1.08394999999999974705
1.02110000000000056275
1.16205000000000069349
0.98930000000000006821
1.04397499999999965326
1.05640000000000000568
1.04222500000000017906
1.00947500000000012221
1.03972500000000067644
1.03240000000000087255
1.00717500000000015348
1.06682499999999969020
1.05504999999999959925
1.01665000000000027569
];

sigma4_5 = [1.08184999999999931219
1.07972499999999982379
1.07927499999999909619
1.11919999999999930651
1.15950000000000130740
1.05124999999999957367
1.03372500000000044906
1.13242500000000134719
1.12424999999999997158
1.09570000000000078444
1.06769999999999853912
1.12867500000000120508
1.12294999999999944862
0.98482500000000072760
1.11465000000000102887
1.20990000000000108571
1.04222499999999840270
1.09035000000000081855
1.13619999999999876650
1.11560000000000059117
1.17030000000000100613
1.13367500000000021032
1.04980000000000117666
1.03677499999999866986
1.03857500000000158025
1.10135000000000005116
0.99122500000000002274
1.06287499999999823785
1.12522500000000036380
1.01872499999999988063
1.03897500000000064801
1.12594999999999956231
1.16047500000000169962
1.03734999999999999432
1.13032499999999913598
1.19290000000000162572
1.09882500000000149498
1.09902500000000102887
1.12855000000000060822
1.11074999999999945999
1.21174999999999855049
1.05559999999999831743
1.09029999999999915872
1.10532500000000055707
1.21187499999999914735
1.14092499999999930083
1.27357500000000101181
1.02680000000000148930
1.12665000000000148361
1.12085000000000079012
1.18990000000000151203
1.05062500000000014211
1.04582500000000067075
1.10715000000000074465
1.13112500000000082423
1.13787500000000108002
1.13847499999999968168
1.19334999999999880060
1.04537499999999994316
1.13227499999999992042
1.10027499999999989200
1.02272500000000121645
1.00817500000000137561
1.14160000000000039222
1.11672499999999885745
1.12715000000000031832
1.11867499999999964189
1.05035000000000167120
1.10742499999999921556
1.07877500000000026148
1.08627500000000054570
1.00832499999999924967
0.98114999999999952252
1.11262500000000130740
1.12099999999999866418
1.09224999999999994316
1.04564999999999841407
1.08132499999999964757
1.06384999999999863007
1.11329999999999884608
1.08605000000000018190
1.10012499999999846523
1.01182500000000175078
1.05677499999999824354
0.97867499999999907345
1.13587499999999863576
1.07457499999999939178
1.21620000000000061391
1.03927499999999994884
1.08372500000000115961
1.09789999999999920988
1.07004999999999839133
1.02232499999999859597
1.08620000000000160867
1.07497499999999845954
1.04404999999999859028
1.09165000000000134150
1.10022499999999823217
1.04694999999999893703
];

sigma1avg_5 = mean(sigma1_5);
sigma2avg_5 = mean(sigma2_5);
sigma3avg_5 = mean(sigma3_5);
sigma4avg_5 = mean(sigma4_5);
subplot(2, 4, 4);
plot([log(8/(pi*sin((pi*1)/8))), log(8/(pi*sin((pi*2)/8))),log(8/(pi*sin((pi*3)/8))),log(8/(pi*sin((pi*4)/8)))],[sigma1avg_5, sigma2avg_5, sigma3avg_5, sigma4avg_5],'bo')
xlabel("ln(L/πsin(πℓ/L))");
ylabel("Sigma^2")
title("L=N=8,nmax = 5")

%% --------------------------------- nmax = 4 -----------------------------------------
sigma1_4 = [0.64135000000000008669
0.62447499999999989129
0.62650000000000005684
0.61159999999999992149
0.62705000000000010729
0.61302499999999993108
0.61064999999999991509
0.61579999999999990301
0.60004999999999997229
0.62494999999999989448
0.62042500000000000426
0.61782500000000006857
0.61440000000000005720
0.63260000000000005116
0.63365000000000004654
0.62260000000000004228
0.64719999999999999751
0.62697500000000006004
0.62522499999999991971
0.60925000000000006928
0.61670000000000002593
0.60257500000000008278
0.64995000000000002771
0.63670000000000004370
0.60982500000000006146
0.64942499999999991900
0.62017499999999992077
0.62539999999999995595
0.63162500000000010303
0.62379999999999991012
0.61690000000000000391
0.61179999999999989946
0.63175000000000003375
0.59572500000000006004
0.64157500000000000639
0.61837499999999989697
0.60769999999999990692
0.63477500000000008917
0.60697500000000004228
0.61220000000000007745
0.62999999999999989342
0.61122499999999990727
0.62402500000000005187
0.61190000000000011049
0.60937500000000000000
0.63729999999999997762
0.59780000000000010907
0.61785000000000001030
0.63844999999999996199
0.63052500000000000213
0.63287500000000007638
0.62247499999999988951
0.60107500000000002593
0.64620000000000010765
0.62802500000000005542
0.60162500000000007638
0.61905000000000010019
0.62952499999999989022
0.61785000000000001030
0.60647500000000009734
0.62420000000000008811
0.61982500000000007034
0.61507500000000003837
0.63579999999999992077
0.59507500000000002061
0.61905000000000010019
0.60985000000000000320
0.60802500000000003766
0.63567499999999999005
0.62232500000000001705
0.62012500000000003730
0.60607499999999991935
0.60882499999999994955
0.62884999999999990905
0.64014999999999999680
0.61432500000000000995
0.60937500000000000000
0.61332499999999989804
0.61874999999999991118
0.61434999999999995168
0.62687500000000007105
0.60657500000000008633
0.60874999999999990230
0.60874999999999990230
0.61467500000000008242
0.63797499999999995879
0.60759999999999991793
0.63410000000000010800
0.60844999999999993534
0.61264999999999991687
0.60234999999999994102
0.61372500000000007603
0.61132499999999989626
0.60390000000000010338
0.62890000000000001457
0.63329999999999997407
0.61329999999999995630
0.62464999999999992752
0.61329999999999995630
0.60167499999999995985
];

sigma2_4 = [0.95862499999999961631
0.92480000000000028848
0.91232500000000005258
0.88562500000000010658
0.93432500000000029416
0.91279999999999983373
0.88872499999999998721
0.90134999999999987352
0.86102499999999970726
0.88884999999999969589
0.92065000000000019043
0.88282500000000041496
0.86492500000000038796
0.94585000000000007958
0.94109999999999960352
0.94407499999999977547
0.99795000000000033680
0.90960000000000018616
0.90854999999999996874
0.88507499999999961204
0.91077500000000011227
0.85435000000000016485
1.00919999999999987494
0.94160000000000021458
0.90017499999999994742
0.96030000000000015348
0.91140000000000043201
0.92162499999999969447
0.94265000000000043201
0.91407500000000041496
0.91349999999999997868
0.89357500000000023022
0.91915000000000013358
0.86397499999999993747
0.93379999999999974136
0.91442499999999959925
0.92207500000000042206
0.96780000000000043769
0.89947499999999980247
0.89655000000000040217
0.94545000000000012363
0.93737500000000029132
0.91959999999999997300
0.88135000000000029985
0.90899999999999980815
0.94570000000000042917
0.86917500000000025295
0.91387499999999999289
0.96882499999999982521
0.93247500000000016485
0.92787500000000022737
0.90027499999999971436
0.88865000000000016200
0.93812500000000031974
0.90472500000000000142
0.88719999999999998863
0.91035000000000021458
0.94315000000000015490
0.88279999999999958504
0.85642499999999976978
0.93165000000000031122
0.94207499999999999574
0.91234999999999999432
0.95629999999999970584
0.87265000000000014779
0.88512500000000038369
0.86687500000000028422
0.85922500000000034959
0.95000000000000017764
0.93940000000000001279
0.90317500000000006111
0.92102500000000020464
0.87289999999999956515
0.90627499999999994174
0.95929999999999981952
0.88949999999999995737
0.88964999999999960778
0.88834999999999997300
0.87767499999999998295
0.89165000000000027569
0.94017499999999998295
0.86605000000000043059
0.86417500000000035953
0.89810000000000034248
0.88052499999999955804
0.95612500000000011369
0.87962499999999987921
0.93942499999999995453
0.88030000000000008242
0.88109999999999999432
0.84632500000000021600
0.89827499999999993463
0.87309999999999998721
0.88924999999999965183
0.94629999999999991900
0.92835000000000000853
0.88295000000000012363
0.90214999999999978542
0.89922500000000038511
0.88020000000000031548
];

sigma3_4 = [1.09832500000000088392
1.03477499999999977831
1.03340000000000031832
0.99487500000000039790
1.10032499999999977547
1.06765000000000043201
1.02682500000000054285
1.03787499999999965894
0.97722500000000067644
0.98509999999999919851
1.08082500000000081286
0.97639999999999993463
0.97107500000000079865
1.08290000000000041780
1.08742499999999964189
1.10979999999999989768
1.16184999999999938325
1.02777500000000010516
1.00655000000000072191
0.99949999999999938893
1.04935000000000044906
0.94532500000000041496
1.20092499999999979821
1.07862500000000061107
1.03147500000000036380
1.07360000000000077591
1.04914999999999913882
1.06550000000000011369
1.10665000000000013358
1.06825000000000081002
1.05782499999999934914
1.04122500000000073328
1.04064999999999940883
0.96555000000000035243
1.05470000000000041496
1.04679999999999928662
1.07080000000000019611
1.13904999999999922977
1.03534999999999932641
1.02120000000000032969
1.07750000000000056843
1.10110000000000063380
1.04524999999999934630
1.00384999999999990905
1.03997500000000009379
1.11562499999999964473
0.98032500000000055707
1.04519999999999946283
1.14637500000000081002
1.07237499999999918998
1.04152500000000003411
1.02352499999999935199
0.99029999999999951399
1.05090000000000038938
1.03877499999999933777
1.02102499999999984936
1.05279999999999951399
1.09377500000000082991
0.98872500000000052012
0.97137500000000009948
1.07312499999999921840
1.09745000000000025864
1.05567500000000080718
1.09839999999999982094
0.99810000000000087539
0.99612499999999926104
0.99357499999999987494
0.97887500000000038369
1.12127500000000068781
1.09702500000000036096
1.01754999999999995453
1.05930000000000035243
0.98027500000000067359
1.04904999999999937188
1.11462500000000019895
1.00717500000000015348
1.01565000000000082991
1.02332499999999981810
1.00779999999999958504
1.03052500000000080149
1.10769999999999946283
1.00680000000000013927
0.99962499999999998579
1.03514999999999979252
0.99942500000000045191
1.08662499999999972999
1.00107500000000015916
1.08607499999999923546
1.01872499999999988063
0.99465000000000003411
0.95594999999999963336
1.05985000000000084697
1.00600000000000022737
1.02120000000000032969
1.09970000000000034390
1.09094999999999942020
0.99427500000000001990
1.00619999999999976126
1.02552500000000001990
0.99187500000000028422
];

sigma4_4 = [1.12349999999999994316
1.05724999999999980105
1.07867500000000049454
1.01914999999999977831
1.14624999999999843681
1.12287500000000051159
1.07747499999999973852
1.09317499999999867555
1.01399999999999934630
1.02844999999999942020
1.12780000000000057980
1.00787499999999852207
1.01154999999999972715
1.09100000000000108002
0.97082500000000138130
1.24919999999999831175
1.12387500000000173372
1.06647500000000050591
1.10492500000000148930
1.08627500000000054570
1.10729999999999861870
1.15559999999999973852
1.11664999999999992042
1.11562500000000142109
1.09860000000000113118
1.07369999999999876650
0.99595000000000055707
1.09002500000000068781
1.09080000000000154614
1.12067499999999853344
1.19532500000000041496
1.06330000000000168825
1.05522500000000007958
1.11589999999999989200
1.16137499999999960210
1.07629999999999981242
1.03764999999999929514
1.05592499999999844817
1.17592499999999944293
1.02327500000000171099
1.07685000000000030695
1.22125000000000127898
1.11472499999999996589
1.06480000000000174509
1.06087499999999934630
1.01555000000000106297
1.07215000000000060254
1.08672500000000127329
1.06859999999999999432
1.09032499999999998863
1.13139999999999929514
1.02965000000000017621
1.00619999999999976126
1.10160000000000124487
1.16007499999999907914
1.10559999999999902798
1.15277499999999832880
1.03125000000000000000
1.02284999999999826059
1.03140000000000142677
1.01754999999999995453
1.18305000000000148930
1.15135000000000076170
1.04257499999999936335
1.09982499999999916440
1.00837500000000090949
1.10227499999999878355
1.17709999999999936904
1.02775000000000105160
1.06319999999999836859
1.06192499999999867555
1.05199999999999960210
1.06017500000000097771
1.16584999999999894271
1.06015000000000014779
1.03367499999999878924
1.07495000000000118234
1.04817500000000052296
1.14647499999999880060
1.04165000000000063096
1.14229999999999876081
1.05904999999999915872
1.01835000000000164277
0.99377499999999940883
1.10457500000000052864
1.05474999999999852207
1.07262499999999860734
1.13672499999999843112
1.16700000000000159162
1.05099999999999837996
1.03872499999999945430
1.05809999999999959641
1.00700000000000144951
];

sigma1avg_4 = mean(sigma1_4);
sigma2avg_4 = mean(sigma2_4);
sigma3avg_4 = mean(sigma3_4);
sigma4avg_4 = mean(sigma4_4);
subplot(2, 4, 5);
plot([log(8/(pi*sin((pi*1)/8))), log(8/(pi*sin((pi*2)/8))),log(8/(pi*sin((pi*3)/8))),log(8/(pi*sin((pi*4)/8)))],[sigma1avg_4, sigma2avg_4, sigma3avg_4, sigma4avg_4],'bo')
xlabel("ln(L/πsin(πℓ/L))");
ylabel("Sigma^2")
title("L=N=8,nmax = 4")

%% --------------------------------- nmax = 3 -----------------------------------------
sigma1_3 = [0.57977499999999992930
0.79945000000000021600
0.89292499999999996874
0.91342500000000015348
0.58272499999999993747
0.83399999999999963052
0.94467500000000015348
0.96669999999999944862
0.59260000000000001563
0.84030000000000004690
0.95289999999999963620
1.00127499999999969305
0.57667500000000004867
0.81890000000000018332
0.91194999999999915019
0.93655000000000043769
0.59507500000000002061
0.84882499999999971863
0.96875000000000000000
1.00902500000000117097
0.58214999999999994529
0.82864999999999966462
0.91314999999999990621
0.92970000000000041496
0.58535000000000003695
0.84337499999999998579
0.95304999999999928662
0.98645000000000138130
0.59099999999999996980
0.83402499999999957225
0.92847500000000060538
0.96849999999999880629
0.58017500000000010729
0.81202500000000021885
0.90455000000000040927
0.94197499999999934062
0.59210000000000007070
0.82530000000000036664
0.91305000000000013927
0.95674999999999954525
0.59224999999999994316
0.83867500000000028137
0.93652499999999960778
0.96237500000000153477
0.60820000000000007390
0.89280000000000026006
1.02822500000000083276
1.06510000000000104592
0.57897500000000001741
0.79729999999999989768
0.87850000000000072475
0.90974999999999894840
0.58820000000000005613
0.86237500000000011369
1.00895000000000045759
1.05399999999999849365
0.58167499999999994209
0.80790000000000006253
0.90217499999999972715
0.93130000000000023874
0.60109999999999996767
0.84435000000000037801
0.93805000000000049454
0.97077499999999972147
0.57882499999999992291
0.82377500000000036806
0.92934999999999945430
0.95309999999999917009
0.58237500000000008704
0.82612500000000022027
0.92750000000000021316
0.94685000000000130171
0.58489999999999997549
0.82080000000000019611
0.92772500000000057696
0.94767500000000026716
0.60739999999999993996
0.84900000000000019895
0.95274999999999998579
0.99824999999999874944
0.58212500000000000355
0.82345000000000023732
0.91414999999999935199
0.93035000000000067644
0.57689999999999996838
0.78552499999999980673
0.86219999999999963336
0.88867499999999921556
0.58527499999999998970
0.83252500000000040359
0.93140000000000000568
0.94930000000000092086
0.59362500000000006928
0.85280000000000022453
0.96710000000000029274
0.99879999999999924398
0.59082499999999993356
0.85332499999999988916
0.96085000000000064801
0.98902500000000159730
0.59390000000000009450
0.82725000000000026290
0.92597499999999932641
0.96049999999999968736
0.60177499999999994884
0.85329999999999994742
0.93774999999999941735
0.94972500000000081855
0.61614999999999997549
0.87765000000000004121
0.97760000000000069065
1.00349999999999894840
0.58774999999999999467
0.84247500000000030695
0.97710000000000007958
1.02137499999999903366
0.58832499999999998685
0.81845000000000034390
0.92784999999999939746
0.95015000000000071623
0.59210000000000007070
0.86532500000000034390
0.97217500000000001137
0.98525000000000062528
0.60197499999999992681
0.85414999999999974278
0.95045000000000001705
0.98554999999999992610
0.59702499999999991687
0.84734999999999960352
0.93072500000000069065
0.94992500000000035243
0.59349999999999991651
0.83249999999999957367
0.93304999999999971294
0.95414999999999849933
0.59349999999999991651
0.84272499999999972431
0.94185000000000052012
0.97285000000000110276
0.57879999999999998117
0.81712499999999987921
0.92549999999999954525
0.94519999999999981810
0.58454999999999990301
0.81285000000000007248
0.92297499999999921272
0.96000000000000085265
0.59965000000000001634
0.84884999999999966036
0.95579999999999998295
0.98645000000000138130
0.57747499999999996056
0.79680000000000017479
0.88992499999999985505
0.92095000000000126761
0.58127499999999998614
0.82235000000000013642
0.92912500000000086686
0.94182500000000146656
0.59297500000000002984
0.83252500000000040359
0.92912500000000086686
0.94782500000000169393
0.58725000000000004974
0.84895000000000031548
0.98440000000000082991
1.00967500000000143245
0.58695000000000008278
0.85024999999999995026
0.97127500000000033253
1.00639999999999929514
0.58414999999999994706
0.82425000000000014921
0.95062500000000049738
0.98920000000000030127
0.59495000000000008988
0.85444999999999993179
0.97419999999999973284
1.00444999999999851070
0.57047500000000006537
0.82377500000000036806
0.92525000000000012790
0.94790000000000063096
0.59210000000000007070
0.84027500000000010516
0.96532499999999998863
1.00142500000000111982
0.57622499999999998721
0.81090000000000017621
0.89755000000000073612
0.92139999999999844249
0.58817499999999989235
0.82412500000000044054
0.92327500000000028990
0.94792500000000146088
0.58692499999999991900
0.83527500000000021174
0.95960000000000000853
0.98727500000000034674
0.58522500000000010623
0.81920000000000037232
0.91900000000000048317
0.944974999999
];

sigma2_3 = [0.79945000000000021600
0.83399999999999963052
0.84030000000000004690
0.81890000000000018332
0.84882499999999971863
0.82864999999999966462
0.84337499999999998579
0.83402499999999957225
0.81202500000000021885
0.82530000000000036664
0.83867500000000028137
0.89280000000000026006
0.79729999999999989768
0.86237500000000011369
0.80790000000000006253
0.84435000000000037801
0.82377500000000036806
0.82612500000000022027
0.82080000000000019611
0.84900000000000019895
0.82345000000000023732
0.78552499999999980673
0.83252500000000040359
0.85280000000000022453
0.85332499999999988916
0.82725000000000026290
0.85329999999999994742
0.87765000000000004121
0.84247500000000030695
0.81845000000000034390
0.86532500000000034390
0.85414999999999974278
0.84734999999999960352
0.83249999999999957367
0.84272499999999972431
0.81712499999999987921
0.81285000000000007248
0.84884999999999966036
0.79680000000000017479
0.82235000000000013642
0.83252500000000040359
0.84895000000000031548
0.85024999999999995026
0.82425000000000014921
0.85444999999999993179
0.82377500000000036806
0.84027500000000010516
0.81090000000000017621
0.82412500000000044054
0.83527500000000021174
0.81920000000000037232
0.81432500000000018758
0.81452499999999972147
0.81192499999999956373
0.84542499999999964899
0.85235000000000038511
0.84794999999999998153
0.84937500000000021316
0.82005000000000016769
0.84612499999999979394
0.81712499999999987921
0.80717499999999997584
0.79607500000000008811
0.81757499999999971863
0.80557500000000015206
0.83919999999999994600
0.81762499999999960210
0.85609999999999963904
0.84607499999999991047
0.84807499999999969020
0.84302499999999991331
0.83132499999999964757
0.80062500000000014211
0.83382500000000003837
0.85127500000000022595
0.83685000000000009379
0.84127500000000043912
0.82964999999999999858
0.82767500000000016058
0.78155000000000018900
0.86265000000000036096
0.83557500000000040075
0.81262499999999970868
0.84494999999999986784
0.81082500000000035101
0.80967500000000036664
0.82557499999999972573
0.82377500000000036806
0.85122500000000034248
0.83357499999999973284
0.84215000000000017621
0.85005000000000041638
0.81532499999999963336
0.89532499999999970441
0.81020000000000003126
0.84060000000000023590
0.80572499999999980247
0.80970000000000030838
0.79777499999999967883
0.80754999999999999005
];

sigma3_3 = [0.89292499999999996874
0.94467500000000015348
0.95289999999999963620
0.91194999999999915019
0.96875000000000000000
0.91314999999999990621
0.95304999999999928662
0.92847500000000060538
0.90455000000000040927
0.91305000000000013927
0.93652499999999960778
1.02822500000000083276
0.87850000000000072475
1.00895000000000045759
0.90217499999999972715
0.93805000000000049454
0.92934999999999945430
0.92750000000000021316
0.92772500000000057696
0.95274999999999998579
0.91414999999999935199
0.86219999999999963336
0.93140000000000000568
0.96710000000000029274
0.96085000000000064801
0.92597499999999932641
0.93774999999999941735
0.97760000000000069065
0.97710000000000007958
0.92784999999999939746
0.97217500000000001137
0.95045000000000001705
0.93072500000000069065
0.93304999999999971294
0.94185000000000052012
0.92549999999999954525
0.92297499999999921272
0.95579999999999998295
0.88992499999999985505
0.92912500000000086686
0.92912500000000086686
0.98440000000000082991
0.97127500000000033253
0.95062500000000049738
0.97419999999999973284
0.92525000000000012790
0.96532499999999998863
0.89755000000000073612
0.92327500000000028990
0.95960000000000000853
0.91900000000000048317
0.90737500000000004263
0.93327500000000007674
0.92340000000000088676
0.94217500000000065086
0.97635000000000005116
0.94790000000000063096
0.97542499999999954241
0.90462499999999934630
0.95292500000000046612
0.89092499999999930083
0.90722500000000039222
0.85975000000000001421
0.89119999999999954809
0.91137499999999960210
0.94172499999999992326
0.92409999999999925535
0.94340000000000046043
0.95527500000000031832
0.93624999999999936051
0.96292500000000025295
0.92302500000000087255
0.90055000000000084981
0.94144999999999967599
0.99399999999999977263
0.93527500000000074465
0.96005000000000073612
0.93229999999999968452
0.93595000000000005969
0.86459999999999936904
0.97607499999999980389
0.96062500000000028422
0.94369999999999976126
0.94817500000000087823
0.92295000000000015916
0.91947500000000026432
0.93019999999999924967
0.93617500000000042348
0.94307500000000032969
0.94025000000000069633
0.94214999999999982094
0.94405000000000072191
0.92065000000000019043
1.04472499999999968168
0.90537499999999937472
0.94549999999999911893
0.89564999999999983515
0.90445000000000064233
0.88700000000000045475
0.90949999999999953104
];

sigma4_3 = [0.91342500000000015348
0.96669999999999944862
1.00127499999999969305
0.93655000000000043769
1.00902500000000117097
0.92970000000000041496
0.98645000000000138130
0.96849999999999880629
0.94197499999999934062
0.95674999999999954525
0.96237500000000153477
1.06510000000000104592
0.90974999999999894840
1.05399999999999849365
0.93130000000000023874
0.97077499999999972147
0.95309999999999917009
0.94685000000000130171
0.94767500000000026716
0.99824999999999874944
0.93035000000000067644
0.88867499999999921556
0.94930000000000092086
0.97484999999999999432
0.96049999999999968736
0.94972500000000081855
1.00349999999999894840
1.02137499999999903366
0.95015000000000071623
0.98525000000000062528
0.98554999999999992610
0.94992500000000035243
0.95414999999999849933
0.97285000000000110276
0.94519999999999981810
0.96000000000000085265
0.98645000000000138130
0.92095000000000126761
0.94182500000000146656
0.94782500000000169393
1.00967500000000143245
1.00639999999999929514
0.98920000000000030127
1.00444999999999851070
0.94790000000000063096
1.00142500000000111982
0.92139999999999844249
0.94792500000000146088
0.98727500000000034674
0.94497499999999945430
0.93120000000000047180
0.96699999999999874944
0.96170000000000044338
0.97285000000000110276
0.99952499999999844249
0.97272500000000050591
1.00840000000000173941
0.94204999999999827764
0.99944999999999950546
0.91022500000000050591
0.94119999999999848228
0.88439999999999940883
0.91432500000000160867
0.93917499999999876081
0.95765000000000100044
0.95250000000000056843
0.96077500000000171099
0.97944999999999993179
0.94675000000000153477
1.00952500000000000568
0.96407500000000112550
0.91862499999999869260
0.97447500000000175646
1.03729999999999833449
0.95847499999999996589
1.01885000000000047748
0.97484999999999999432
0.97677499999999994884
0.88787500000000108002
1.01660000000000039222
1.00925000000000153477
0.98815000000000097202
0.97792499999999904503
0.95684999999999931219
0.93349999999999866418
0.95152500000000017621
0.97670000000000101181
0.95260000000000033538
0.98752500000000154046
0.98335000000000150067
0.95104999999999861870
0.94654999999999844817
1.08729999999999904503
0.93359999999999843112
0.97132500000000021600
0.92119999999999890861
0.93799999999999883471
0.91515000000000057412
0.94170000000000086970
];

sigma1avg_3 = mean(sigma1_3);
sigma2avg_3 = mean(sigma2_3);
sigma3avg_3 = mean(sigma3_3);
sigma4avg_3 = mean(sigma4_3);
subplot(2, 4, 6);
plot([log(8/(pi*sin((pi*1)/8))), log(8/(pi*sin((pi*2)/8))),log(8/(pi*sin((pi*3)/8))),log(8/(pi*sin((pi*4)/8)))],[sigma1avg_3, sigma2avg_3, sigma3avg_3, sigma4avg_3],'bo')
xlabel("ln(L/πsin(πℓ/L))");
ylabel("Sigma^2")
title("L=N=8,nmax = 3")

%% --------------------------------- nmax = 2 -----------------------------------------
sigma1_2 = [.44];

sigma2_2 = [.56];

sigma3_2 = [.61];

sigma4_2 = [.65];

sigma1avg_2 = mean(sigma1_2);
sigma2avg_2 = mean(sigma2_2);
sigma3avg_2 = mean(sigma3_2);
sigma4avg_2 = mean(sigma4_2);
subplot(2, 4, 7);
plot([log(8/(pi*sin((pi*1)/8))), log(8/(pi*sin((pi*2)/8))),log(8/(pi*sin((pi*3)/8))),log(8/(pi*sin((pi*4)/8)))],[sigma1avg_2, sigma2avg_2, sigma3avg_2, sigma4avg_2],'bo')
xlabel("ln(L/πsin(πℓ/L))");
ylabel("Sigma^2")
title("L=N=8,nmax = 2")

%% --------------------------------- nmax = 1 -----------------------------------------
sigma1_1 = [0];

sigma2_1 = [0];

sigma3_1 = [0];

sigma4_1 = [0];

sigma1avg_1 = mean(sigma1_1);
sigma2avg_1 = mean(sigma2_1);
sigma3avg_1 = mean(sigma3_1);
sigma4avg_1 = mean(sigma4_1);
subplot(2, 4, 8);
plot([log(8/(pi*sin((pi*1)/8))), log(8/(pi*sin((pi*2)/8))),log(8/(pi*sin((pi*3)/8))),log(8/(pi*sin((pi*4)/8)))],[sigma1avg_1, sigma2avg_1, sigma3avg_1, sigma4avg_1],'bo')
xlabel("ln(L/πsin(πℓ/L))");
ylabel("Sigma^2")
title("L=N=8,nmax = 1")
